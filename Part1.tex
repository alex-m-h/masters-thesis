\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{xcolor}
\usepackage{csquotes}
\usepackage{faktor}
\usepackage{mathrsfs}
\usepackage{mathtools}

\usepackage{biblatex}
\addbibresource{bibliography.bib}
% \bibliography{bibliography}
% \bibliographystyle{ieeetr}


\newtheorem{proposition}{Proposition}
\newtheorem{theorem}{Theorem}

\theoremstyle{definition}
\newtheorem{assumption}{Assumption}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newtheorem{problem}{Problem}

\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator{\curl}{curl}
\DeclareMathOperator{\diver}{div}

\newcommand{\aop}{\mathscr{A}}
\newcommand{\alternating}[2]{ {\text{Alt}^{#1}\,#2} }
\newcommand{\integers}{\mathbb{Z}}
\newcommand{\smoothcompforms}[2]{C_0^\infty \Lambda^{#1}(#2)}
\newcommand{\lpcoho}{H^k_{p,dR}}
\newcommand{\norm}[1]{\lVert #1 \rVert}
\newcommand{\omegabar}{\overline{\Omega}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\rop}{\mathscr{R}} % short for R operator


\begin{document}

Our goal is to study the homogeneous magnetostatic problem on the exterior 
domain of a triangulated torus. That means 
that for the unbounded domain  $\Omega \subseteq \real^3$ we have
$\real^3 \setminus \Omega$ is a triangulated torus. We also need a 
piecewise straight (i.e. triangulated) closed curve around the torus.
%%% TBD: Picture
{\color{red} (TBD: Define the "triangulated torus" more rigorous)}

Let $B$ be a magnetic field on the domain $\Omega$.
We the have the following boundary value problem:

\begin{align}
    \curl \, B &= 0, \\ 
    \diver \, B  &= 0 \text{ in } \Omega \\
    B \cdot n &= 0 \text{ on } \partial \Omega \text{ and }\\
    \int_\gamma B \cdot dl &= C_0
\end{align}
where $n$ is the outward normal vector field on $\partial \Omega$ and 
$C_0 \in \real$. We want to prove existence and uniqueness of 
solutions. In order to do so we will need to introduce Sobolev spaces of 
differential forms and basics from
simplicial topology.

At first, let us introduce some basic notions about differential forms. 
We follow the brief introduction given by Arnold (cf. \cite[Sec. 6.1]{arnold}), 
but less details will be given. 
Let $V$ be a real vector space with $\text{dim}\,V = n$ 
    and $\text{Alt}^k\,V$ be the 
space of $k$-alternating maps from $V^k$ to $\real$. For $\omega \in 
\alternating{k}{V}$, $\mu \in 
\alternating{l}{V}$ we define the wedge product $\omega \wedge \mu \in 
\alternating{k+l}{V}$ 
\begin{align*}
    (\omega \wedge \mu) (v_1,...,v_k,v_{k+1},...,v_{k+l}) =
    \sum\limits_{\substack{i_1 < ... < i_k \\ i_{k+1} < ... < i_{k+l}}}
    \text{sgn}(i_1,...,i_{k+l}) \omega(v_{i_1},...,v_{i_k}) 
    \nu(v_{i_{k+1}},...,v_{i_{k+l}})
\end{align*}
where $\text{sgn}(i_1,...,i_{k+l})$ is the sign of the permutation 
$(1,...,k+l) \mapsto (i_1,...,i_{k+l})$. This definition is not very intuitive.
{\color{red} TBD: Examples in 3D}.

Let $\{ u_i\}_{i=1}^n$ be any basis of $V$ and $\{ u^i\}_{i=1}^n$ the 
correspoding dual basis. Then 
\begin{align*}
    \{u^{i_1} \wedge u^{i_2} \wedge ... \wedge u^{i_k} | \, 
    1 \leq i_1 < ... < i_k \leq n \}
\end{align*}
is a basis of $\alternating{k}{V}$. In particular, 
$\dim\, \alternating{k}{V} = \binom{n}{k}$.

Given a inner product $\langle\cdot, \cdot \rangle_V$ on $V$ we obtain an inner 
product on $\alternating{k}{V}$ by defining
\begin{align*}
    \langle u^{i_1} \wedge u^{i_2} \wedge... \wedge u^{i_k}, 
    u^{j_1} \wedge... \wedge u^{j_k} \rangle_{\alternating{k}{V}} 
    \vcentcolon= \det \left[ ( \langle u_{i_k}, u_{i_l} \rangle_V )_
    {1\leq k,l \leq n} \right] 
\end{align*}
which is then extended to all of $\alternating{k}{V}$ by linearity. 
We denote with $\lVert \cdot \rVert _\alternating{k}{V}$ the induced norm.
From this definition it follows directly that for a orthonormal basis 
$b_1$,..., $b_n$ the corresponding basis 
$b^{i_1} \wedge b^{i_2} \wedge ... \wedge b^{i_k}$, 
$1\leq i_1 < ... < i_k \leq n$ is an orthonormal basis of $\alternating{k}{V}$.


$\alternating{n}{V}$ is one-dimensional and so we have to choose a basis.
We say that two orthonormal bases of $V$ 
have the same orientation if the change of basis has positive determinant. 
That divides the orthonormal bases into two classes with different orientation.
We choose one of these classes and call these orthonormal bases positively
oriented. Take $\omega \in \alternating{n}{V}$. Then 
$\omega(b_1,...,b_n)$ is the same for any positively oriented orthornormal
basis. We now define the \textit{volume form} vol $\in \alternating{n}{v}$ by requiring
it to be $1$ on all positively oriented orthonormal bases. Using this volume 
form we can now define the \textit{Hodge star operator} 
$*: \alternating{k}{V} \rightarrow \alternating{n-k}{V}$ via the property 
\begin{align*}
    \omega \wedge \mu = \langle *\omega, \mu \rangle_{\alternating{n-k}{V}} 
    \text{vol}
    \quad \forall \omega \in \alternating{k}{V} , \, 
    \mu \in \alternating{n-k}{V}.
\end{align*}
The Hodge star is an isometry, we have $** = (-1)^{k(n-k)}\text{Id}$ and 
\begin{align*}
    \omega \wedge *\mu = \langle \omega, \mu \rangle_{\alternating{k}{V}} 
    \text{vol} \quad \forall \omega, \mu \in \alternating{k}{V}.
\end{align*}
In particular in $\real^3$, we have $** = \text{Id}$ i.e. $*$ is self-inverse.


Now we will move on to differential forms. We will mostly deal with the
case $V = \real^n$ and denote $\text{Alt}^k\,\real^n$ just as $\text{Alt}^k$.
Let $\Omega \subseteq \real^n$ be a Lipschitz domain and denote the space 
of differential forms of degree $k$ on $\Omega$ as $\Lambda^k(\Omega)$.
We extend the Hodge star operator to differential forms 
$*: \Lambda^k(\Omega) \rightarrow \Lambda^{n-k}(\Omega)$ simply by applying it 
pointwise.


Then
we define the $L_p$-norm of a $k$-form $\omega$ for $1\leq p < \infty$
as (cf. \cite{goldshtein})
\begin{align*}
\lVert \omega \rVert _{L_p^k(\Omega)}\vcentcolon=
\left(\int_\Omega \lVert \omega \rVert _{\text{Alt}^k}^p \right)^{1/p}
\end{align*}
%%% TBD: Is this independent of coordinates i.e. does this notation make sense?
and for $p=\infty$ as
\begin{align*}
\esssup_{x\in \Omega} \, \lVert \omega(x) \rVert _{\text{Alt}^k}.
\end{align*}
$L_p^k(\Omega)$ are the spaces of $k$-forms 
s.t. the corresponding $L_p$-norm is finite.
For $p=2$ we obtain a Hilbert space (cf. \cite[Sec. 6.2.6]{arnold}) 
with the $L_2$ inner product  
\begin{align}
\langle \omega, \nu \rangle \vcentcolon= 
\int_\Omega \langle \omega, \nu \rangle _{\text{Alt}^k}. 
\label{def_inner_product}
\end{align}
\begin{proposition}
    The Hodge star operator $*:L^k_2(\Omega) \rightarrow L^{n-k}_2(\Omega)$ is a
    Hilbert space isometry.
\end{proposition}
\begin{proof}
    This follows directly from the definition of the inner product 
    (\refeq{def_inner_product}) and the fact that $*$ is an isometry 
    when applied to alternating forms $\text{Alt}^k$.
\end{proof}


Our next goal is to extend the exterior derivative $d$ 
of smooth differential forms in the weak sense (cf. \cite{goldshtein}). 
Let $\mathring{d}: L^k_2(\Omega) \rightarrow L^{k+1}_2(\Omega)$ be the exterior
derivative as an unbounded operator with domain 
$D(\mathring{d}) = \smoothcompforms{k}{\Omega}$ 
which are the smooth compactly supported differential forms of degree $k$. 
Analogous, let 
$\mathring{\delta}: L^k_2(\Omega) \rightarrow L^{k-1}_2(\Omega)$ be the 
codifferential operator $\mathring{\delta} \vcentcolon= 
(-1)^{n(k-1)+1}*\mathring{d}*$ also with domain $\smoothcompforms{k}{\Omega}$.

Then the exterior derivative $ d\omega \in L^p_{k+1}(\Omega)$ is defined as
the unique $(k+1)$-form in $L^p_{k+1}(\Omega)$ s.t. 
\begin{align*}
\int_\Omega d\omega \wedge *\phi = \int_\Omega \omega \wedge 
*\mathring{\delta}\phi
\quad \forall \phi \in C_0^\infty \Lambda^{k}(\Omega).
\end{align*}
Just as in the usual Sobolev setting we define the following spaces:
\begin{align*}
W^k_p(\Omega) &= \left\{ \omega \in L^k_p(\Omega)\, | 
    \, d\omega \in L_p^{k+1}(\Omega) \right\}, \\ 
W^k_{p,loc}(\Omega) &= \left\{ \omega \, k \text{-form} \, | \,
\omega|_A \in W^k_p(A) \text{ for every open } A \subseteq \Omega 
\text{ s.t. } \overline{A} \subseteq \Omega \text{ is compact} %TBD: Check that this is right
\right\}.
\end{align*}
For $\omega \in W^k_p(\Omega)$ for $p<\infty$ we define the norm 
\begin{align*}
\lVert \omega \rVert _{W^k_p} &\vcentcolon= 
\left( \norm{\omega}^p_{L^k_p} + \norm{d\omega}^p_{L^k_p} \right)^{1/p}
\end{align*}
and for $p=\infty$
\begin{align*}
    \lVert \omega \rVert _{W^k_\infty} &\vcentcolon= 
    \max\left\{ \norm{\omega}_{L^k_\infty},\, \norm{d\omega}_{L^k_\infty}
    \right\}.
\end{align*}
    
\begin{definition}[$L^p$-cohomology]
    We define the following subspaces of $W^k_p(\Omega)$, $1\leq p \leq\infty$:
    \begin{align*}
        \mathfrak{B}_k &\vcentcolon= dW^{k-1}_p(\Omega) \text{ and} \\
        \mathfrak{Z}_k &\vcentcolon= \{ \omega \in W^k_p(\Omega)| 
        \, d\omega = 0\}.
    \end{align*}
    We call the $k$-forms in $\mathfrak{B}_k$ exact and the forms in 
    $\mathfrak{Z}_k$ closed. Because $d \circ d=0$ we always have  
    $\mathfrak{B}_k \subseteq \mathfrak{Z}_k$.
    Then we define the de Rham- or $L^p$-cohomology space $\lpcoho(\Omega)$ as 
    the quotient space
    \begin{align*}
        \lpcoho (\Omega) \vcentcolon= \faktor{\mathfrak{Z}_k}{\mathfrak{B}_k}.
    \end{align*}
\end{definition}
\vspace{0.5cm}
We want to examine the Hilbert space $L^k_2(\Omega)$ more closely
(see \cite[Sec. 6.2.6]{arnold} for more details).  
%%% TBD: This is only for bounded domains. What changes?
% Picard defines it as completion of smooth functions \cite[p.37]{picard}
We denote $H^k(d;\Omega) \vcentcolon= W^k_2(\Omega)$. If the domain is clear
we will leave it out. Note that the above definition of the exterior derivative
is in the Hilbert space setting equivalent to defining $d$ as the adjoint
of $\mathring{\delta}$. 


% In order to extend $\mathring{\delta}$ as well, we will need the following
Now we just define $\delta \vcentcolon= (-1)^{n(k-1)+1}*d*$ as in the smooth
setting. We will show that this is the adjoint of $\mathring{d}$. Denote with
$D(\mathring{d}^*) \subseteq L_2^{k+1}(\Omega)$ the domain of the adjoint. 
Define 
\begin{align*}
    H^k(\delta; \Omega) \vcentcolon= \{ \omega \in L^k_2(\Omega) | \,
    *\omega \in H^{n-k}(d) \}.
\end{align*}
Now take $\omega \in H^{k+1}(\delta)$ and $\phi \in 
\smoothcompforms{k}{\Omega}$. Then 
\begin{align*}
    &\langle \delta \omega, \phi \rangle = 
    (-1)^{nk+1} \langle *d* \omega, \phi \rangle \\  
    &= (-1)^{nk+1} (-1)^{k(n-k)} \langle d* \omega, *\phi \rangle =
    (-1)^{nk+1} (-1)^{k(n-k)} 
        \langle * \omega, \mathring{\delta}*\phi \rangle \\
    &= (-1)^{nk+1} (-1)^{k(n-k)} (-1)^{n(n-k-1)+1}
        \langle * \omega, *\mathring{d}**\phi \rangle \\
    &=(-1)^{n(n-1)+2} (-1)^{k(n-k)} \langle \omega, \mathring{d}**\phi \rangle\\
    &= \langle \omega, \mathring{d}\phi \rangle
\end{align*}
where we used repeatedly that $*$ is an isometry and 
$** = (-1)^{k(n-k)}\text{Id}$. This shows that $H^{k+1}(\delta) \subseteq 
D(\mathring{d}^*)$ and that $\mathring{d}^* \omega = \delta \omega$. Now for 
the other inclusion assume that $\omega \in D(\mathring{d}^*)$ and take 
$\phi \in \smoothcompforms{n-k}{\Omega}$ arbitrary.
\begin{align*}
    \langle *\omega, \mathring{\delta}\phi \rangle = \pm 
    \langle \omega, \mathring{d}*\phi \rangle = 
    \pm \langle \mathring{d}^* \omega, *\phi \rangle = 
    \pm \langle *\mathring{d}^* \omega, \phi \rangle.
\end{align*} 
Here we use $\pm$ to mean that we choose the sign correctly, s.t. all the
operations are correct. Then by choosing the sign appropriately we find that
$ \pm *\mathring{d}^* \omega = d*\omega$ and therefore 
$*\omega \in H^{n-k-1}(d)$ so we proved $D(\mathring{d}^*) \subseteq 
H^{k+1}(\delta)$ and we are done.


We then define 
additionally the space $\mathring{H}^k(d;\Omega)$ as the closure of 
$C_0^\infty \Lambda^k(\Omega) \subseteq H^k(d;\Omega)$ w.r.t. 
the $H^k(d)$-norm i.e. 
$\mathring{H}^k(d;\Omega)$ corresponds to $k$-forms in $H^k(d;\Omega)$
being zero on the boundary. {\color{red} TBD: There are several different 
ways to characterize zero boundary conditions in the $L^2$ setting. We have
to choose the one that works best.} % I should probably take Picard's definition
% because I want to use his Hodge decomposition 
Then we define the spaces 
\begin{align*}
    H^k_0(d;\Omega) &\vcentcolon= \{ \omega \in H^k(d;\Omega) 
    | d\omega = 0 \} \\
    \mathring{H}^k_0(d;\Omega) &\vcentcolon= \{ \omega \in \mathring{H}^k(d;\Omega) 
    | d\omega = 0 \}
\end{align*}
i.e. the spaces of closed forms. We will use the analogous definition for 
$H^k_0(\delta;\Omega)$ and $\mathring{H}^k_0(\delta;\Omega)$ which we call 
coclosed forms. We then define the spaces of harmonic forms
\begin{align*}
    \mathring{H}^k_0(d,\delta;\Omega) \vcentcolon= 
    \{ \omega \in \mathring{H}^k(d;\Omega) 
    | \, d\omega = 0, \delta\omega = 0 \}.
\end{align*}
With this one can prove the Hodge decomposition (\cite[Lemma 1]{arnold})
\begin{align}
    L_2^k(\Omega) = \overline{d\mathring{H}^{k-1}(d)} \stackrel{\perp}{\oplus} 
    \mathring{H}^k_0(d,\delta) \stackrel{\perp}{\oplus} 
    \overline{\delta H^{k+1}(\delta)} \label{hodge_decomposition}
\end{align}
and furthermore for the closed and coclosed forms respectively,
\begin{align}
    \mathring{H}^k_0(d) &= \overline{d\mathring{H}^{k-1}(d)} 
    \stackrel{\perp}{\oplus}
    \mathring{H}^k_0(d,\delta) \label{decomposition_closed_forms} \\
    H^k_0(\delta) &= \overline{\delta H^{k+1}(\delta)} \stackrel{\perp}{\oplus}
    \mathring{H}^k_0(d,\delta). \label{decomposition_coclosed_forms}
\end{align}

\section{Tools from Algebraic Topology}

In order to deal with the topological aspects of the problem we need to 
use some results from algebraic topology. This material is taken from 
Chapter 4 and 5 of Bredon's "Topology and Geometry" 
\cite{topology_and_geometry} where a lot more details and results can be found.
We start with the basic definitions from homology.

\begin{definition}[Standard simplex]
    Let $\ell^2$ be the space of real square-summable sequences and 
    $e_1$, $e_2$, ... be the standard orthonormal basis. Then the 
    standard simplex
    $C_k$ is defined as the convex combination of $e_1$, $e_2$, ..., $e_k$
    i.e.
    \begin{align*}
        C_k \vcentcolon= \left\{ \sum\limits_{i=0}^k \lambda_i e_i | \,
        \sum\limits_{i=0}^k \lambda_i = 1,\, 0 \leq \lambda_i \leq 1 \right\}.
    \end{align*}
\end{definition}

\begin{definition}[(Singular) affine simplex]
    Given points $v_0$, $v_1$, ..., $v_k \in \real^n$ we define the map 
    \begin{align*}
        [v_0,...,v_k]: C_k \rightarrow \real^n,\, \
        \sum\limits_{i=0}^k \lambda_i e_i \mapsto 
        \sum\limits_{i=0}^k \lambda_i v_i.
    \end{align*}
    This map is called \textit{affine singular simplex}. If the 
    $v_i$ are additionally affine independent we call it 
    \textit{affine simplex}.
\end{definition}
\noindent This map is well defined because the $\lambda_i$ are the barycentric
coordinates and for every $x \in C_k$ the $\lambda_i \in [0,1]$ 
s.t. $x = \sum_i \lambda_i e_i$ are uniquely determined.

$[e_0,...,\hat{e}_i,...,e_k]$ denotes the affine simplex where the vertex $e_i$
was removed. 
\begin{definition}[Face map]
    The affine simplex $[e_0,...,\hat{e}_i,...,e_k]: C_{k-1} \rightarrow 
    C_k$ is called the $i$-th face map and is denoted by $F_i^k$.
\end{definition}


\begin{definition}[Singular $k$-chain group]
    Let $X$ be a topological space. Then a \textit{singular $k$-simplex} of $X$
    is a continuous map $\sigma_k: C_k \rightarrow X$. 
    The \textit{singular $k$-chain group} $C_k(X)$ is the free abelian
    group based on all singular $k$-simplices i.e. it is the group of all 
    formal finite sums $\sum_\sigma n_\sigma \sigma_k$ with $n_\sigma \in 
    \mathbb{Z}$. We set $C_k(X) = 0$ for $k<0$
\end{definition}

\begin{definition}[Boundary]
    Let $\sigma: C_k \rightarrow X$ be a singular $k$-simplex. Then the 
    \textit{$i$-th face} of $\sigma$ is $\sigma^{(i)}=\sigma \circ F_i^k$.
    The boundary of $\sigma$ is 
    \begin{align*}
        \partial_k \sigma \vcentcolon= \sum\limits_{i=0}^k (-1)^i \sigma^{(i)}.
    \end{align*}
    This is a $(k-1)$-chain. We extend this map to all $k$-chains by
    \begin{align*}
        \partial_k: C_k(X) \rightarrow C_{k-1}(X),\,
        \partial_k(\sum_\sigma n_\sigma \sigma) = 
        \sum_\sigma n_\sigma \partial_k\sigma.
    \end{align*}
\end{definition}

We set $\partial_k = 0$ for $k\leq 0$. 
We have $\partial_k \circ \partial_{k+1} = 0$. The proof is done by direct 
computation, see
\cite[Ch.\,4, Lemma 1.6]{topology_and_geometry}.
We call a $k$-chain $c$ a \textit{$k$-cycle} if $\partial_k c = 0$ 
and we call $c$ 
a \textit{$k$-boundary} if there exists a $(k+1)$-chain $d$ s.t. 
$c = \partial_{k+1} d$ or phrased differently
\begin{align*}
    \text{"$k$-cycles"} &= \text{ker}\,\partial_k =\vcentcolon Z_k(X) \\
    \text{"$k$-boundaries"} &= \text{im}\,\partial_{k+1} =\vcentcolon= B_k(X)
\end{align*}




% \begin{definition}[$k$-chain]
%     Let $K$ be a simplicial complex. A formal linear combination of $k$ 
%     simplices
%     \begin{align*}
%         c = \sum\limits_{\sigma \in K\, k \text{ simplex}} c_\sigma \sigma
%     \end{align*}
%     with $c_\sigma \in \real$ is called \textit{$k$-chain}. The vector space 
%     of all $k$-chains is denoted by ${C}^\text{c}_k$.
% \end{definition}

% These spaces of $k$-chains become now a chain complex by introducing the 
% boundary operator $\partial$.

% \begin{definition}[Boundary]
%     For any simplex $[x_{i_0},\, x_{i_1},...,\, x_{i_k}]$ we define the boundary
%     \begin{align*}
%         \partial[x_{i_0},\, x_{i_1},...,\, x_{i_k}] \vcentcolon=
%         \sum\limits_{j=0}^k (-1)^j [x_{i_0},\, x_{i_1},...,\, 
%         \hat{x}_{i_j},...,\, x_{i_k}]
%     \end{align*}
%     where $[x_{i_0},\, x_{i_1},...,\, \hat{x}_{i_j},...,\, x_{i_k}]$ is the
%     simplex without vertex $x_{i_j}$. We then extend the definition
%     of the boundary operator linearly to $k$-chains 
%     $c = \sum_\sigma c_\sigma \sigma$ by
%     \begin{align*}
%         \partial c \vcentcolon= \sum\limits_\sigma c_\sigma \partial \sigma.
%     \end{align*}.
% \end{definition}

% A crucial property of the chain operator is the following.

% \begin{proposition}
%     $\partial \circ \partial = 0$.
% \end{proposition}
% \begin{proof}
%     This can be proven by direct computation, analogous to 
%     \cite[Chap.4, Lemma 1.6]{topology_and_geometry}
% \end{proof}

We are now ready to define homology groups.
\begin{definition}[Singular homology group]
    The \textit{$k$-th homology group} $H_k(X)$ is the quotient group
    \begin{align*}
        H_k(X) \vcentcolon= \faktor{Z_k(X)}{B_k(X)}.
    \end{align*}
    For a $k$-chain $c$ we write $[c]$ for the corresponding homology class.
\end{definition}

If $H_k(X)$ is finitely generated then its rank is called the 
\textit{$k$-th Betti number}. In the cases that we will consider 
all homology groups will be finitely generated.


\begin{definition}[Simplicial complex]
    
\end{definition}

\noindent The homology spaces are independent of the chosen simplicial complex
\cite{}. %%%TBD: Are you sure? Yes. Answer written on 28.11.2022

Simplices as defined before are maps which is very abstract. The next 
definition is what one commonly thinks of as a simplex in $\real^n$. 
\begin{definition}[Physical simplex]
    Let $x_0$, $x_1$, ..., $x_k \in \real^n$ be affine independent. Then 
    \begin{align*}
    [x_0,x_1,...,x_k] \vcentcolon= \text{conv}\,\{x_0,...,x_k\}
    \end{align*}
    is called physical $k$-simplex.
\end{definition}
\noindent It should be mentioned that Bredon calls these just affine simplices
in \cite{topology_and_geometry}. We changed the naming here to make the 
difference to the affine simplices from above more clear as these are
completely different objects.
%%% TBD: Question: In the book this is defined in infinite dimensions. Does this
%%% lead to any problems?

\begin{definition}[Simplicial complex]
    A \textit{simplicial complex} $K$ is a collection of phyiscal simplices s.t.
    \begin{enumerate}
        \item $\sigma \in K \Rightarrow$ any face of $\sigma$ is in $K$,
        \item $\sigma,\, \tau \in K \Rightarrow \sigma \cap \tau$  
                is either empty or a face of both $\sigma$ and $\tau$.
    \end{enumerate}
    We call $|K| \vcentcolon= \bigcup \{ \sigma | \sigma \in K\}$ 
    the polyhedron of $K$.
\end{definition}
For any topological space $X$ a homeomorphism 
$\tau: |K| \rightarrow X$ is called \textit{triangulation} of $X$.
Let $\{x_1,\, x_2,...\}$ be the vertices in the simplicial complex $K$.
We fix an ordering of the vertices for every simplex. 
That means for any $k$ every $k$ simplex $\sigma$ has
a designated representation in the form of
\begin{align*}
    \sigma = [x_{i_0},\, x_{i_1}, ...,x_{i_k}].
\end{align*} 

In Section\,\ref{sec_isomorphism_cohomology} we will only deal with 
simplicial complexes instead of chain groups.

\begin{definition}[Cochain group]
    Let $G$ be a group. Then we define the \textit{$k$-cochain group} 
    \begin{align*}
        C^k(X;G) \vcentcolon= \text{Hom}(C_k(X),G)
    \end{align*}
    i.e. the group of all homomorphisms from the chain group to $G$.
\end{definition}
\noindent We use a superindex if an object is related to cochains and 
we use a subindex if it is related to chains. In this spirit, we define
\begin{align*}
    \partial^k: C^k(X;G) \rightarrow C^{k+1}(X;G),\, 
    (\partial^k F) (c) \vcentcolon= F(\partial_k c).
\end{align*}

We call  cochain $F \in C^k(X;G)$ \textit{closed} if $\partial^k F = 0$ 
and we call $F$
\textit{exact} if there exists $G \in C^{k+1}(X;G)$ s.t. $F = \partial^{k-1} G$. 
So in analogy to the boundary map we denote
\begin{align*}
    \text{"closed $k$-cochains"} &= \text{ker}\,\partial^k =\vcentcolon 
    Z^k(X;G) \\
    \text{"exact $k$-cochains"} &= \text{im}\,\partial^{k-1} =\vcentcolon 
    B^k(X;G).
\end{align*}
We get immediately from the definition of $\partial^k$ that 
$\partial^k \circ \partial^{k+1} = 0$, analogous to the boundary of chains.


Analogous to the homology groups, we thus obtain the \textit{cohomology groups}.
\begin{definition}[Singular cohomology groups]
    We define the \textit{singular cohomology group}
    as
    \begin{align*}
        H^k(X;G) \vcentcolon= \faktor{Z^k(X;G)}{B^k(X;G)}.
    \end{align*}
\end{definition}
\noindent In our situation later, $G$ will always be the real numbers.


Now the question arises how the homology and cohomology groups are related to
each other. In order to answer this question, we have to introduce
the notion of \textit{exact sequences}.

\begin{definition}[Exact sequence]
    Let $(G_i)_{i\in \integers}$ be a sequence of groups and 
    $(f_i)_{i\in\integers}$ be a sequence of homomorphisms
    $f_i: G_i \rightarrow G_{i+1}$. We call this sequence of homomorphisms
    exact if $\text{im}\,f_{i-1} = \text{ker}\,f_i$.
\end{definition}
Then the \textit{universal coefficient theorem} gives us the following 
exact sequence
\begin{align*}
    0 \rightarrow \text{Ext}(H_{k-1}(X),G) \rightarrow 
    H^k(X;G) \xrightarrow{\beta} \text{Hom}(H_k(x),G) \rightarrow 0
\end{align*}
with the homomorphism
\begin{align*}
    \beta([F])([c]) = F(c).
\end{align*}
The definition of Ext can be found in \cite[Sec.\,V.6]{topology_and_geometry}, 
but the definition does not matter for our purposes because for $G = \real$ 
we get
$\text{Ext}(H_{k-1}(X),G) = 0$. This is because the real numbers are 
a divisible and hence injective group. The definition of these terms and 
the necessary connections can be found in \cite[V.6]{topology_and_geometry}, 
but we will not go any further into the algebraic background.


So we obtain the exact sequence
\begin{align*}
    0 \rightarrow H^k(X;\real) \xrightarrow{\beta} 
    \text{Hom}(H_k(x),\real) \rightarrow 0.
\end{align*}
The exactness gives us $\text{ker}\,\beta = 0$ and 
$\text{im}\,\beta = \text{Hom}(H_k(x),G)$ i.e. $\beta$ is an isomorphism.

As an application let us prove the following proposition that will be used 
later to prove the uniqueness of the magnetostatic problem. %TBD: Section ?
\begin{proposition} \label{uniqueness_cochain_class}
    Assume that $H_1(X) \cong \integers[\gamma]$ i.e. $[\gamma]$ is a generator
    of the homology group. Let $F$ and $G$ both be closed 
    $1$-chains with $F(\gamma)=G(\gamma)$. Then $[F] = [G]$.
\end{proposition} 
\begin{proof}
    Take $c$ be any closed $1$-chain. Then $[c] = [n\gamma]$ for some 
    $n\in \integers$ and thus
    \begin{align*}
        \beta([F])([c]) = \beta([F])(n[\gamma]) = 
        n\;F(\gamma) = n\;G(\gamma) = \beta([G])(n[\gamma]) = \beta([G])([c])
    \end{align*}
    so $\beta([F]) = \beta([G])$. Because $\beta$ is an isomorphism we obtain
    $[F] = [G]$.
\end{proof}


% Next, we define the space of \textit{$k$-cochains} $C^k(K)$ which is nothing 
% else than the dual space of the space of $k$-chains i.e.
% \begin{align*}
%     C^k(K) \vcentcolon= \text{Hom}(C^k_c;\, \real)
% \end{align*}
% where Hom$(X,Y)$ is the space of all vector space homomorphisms (i.e. linear 
% mappings) from $X$ to $Y$.
% We now introduce an operator between these spaces of cochains.
% \begin{definition}
%     We define the operator $\delta: C^k{K} \rightarrow C^{k+1}(K)$ via
%     \begin{align*}
%         (\delta f) (c) \vcentcolon= f(\partial c).
%     \end{align*}
%     We call a cochain $f \in C^k(K)$ \textit{closed} if $\delta f = 0$ 
%     and we call $f$
%     \textit{exact} if there is a $g \in C^{k+1}(K)$ s.t. $f = \delta g$.
% \end{definition}
% We define the cohomology spaces analogous to homology spaces above.
% \begin{definition}[Cohomology of cochains]
%     Denote the space of closed $k$-cochains as $Z^k(K)$ and $B^k(K)$ the space
%     of exact $k$-cochains. We then define the \textit{cohomology spaces}
%     $H^k(K)$ as
%     \begin{align*}
%         H^k(K) \vcentcolon= \faktor{Z^k(K)}{B^k(K)}.
%     \end{align*}
% \end{definition}
% We will later show that if we consider certain subspaces of cochains so called
% \textit{p-summable} cochains that the $L^p$-cohomology defined above and the
% cohomology spaces of these $p$-summable cochains are isomorphic.


% from now on be a an exterior polyhedral domain of a compact set i.e. 
% $\real^3 \setminus \Omega$ 
% is a compact polyhedron. We then have the following boundary value
% problem: For a fixed $C_0 \in \real$ and closed bounded curve $\gamma$ 
% find $\omega \in \mathring{W}^k_2(\Omega)$ s.t.
% \begin{align*}
%     d\omega &= 0, \\
%     \delta\omega &= 0 \text{ and} \\
%     \int_\gamma \omega &= C_0.
% \end{align*}
% Because we consider polyhedral domains we assume that $\gamma$ consists of 
% finitely many $k$-simplices and that the cohomology class $[\gamma]$ is a 
% generator of the simplicial homology space. The well-definedness of the 
% integral over $\gamma$ will be discussed later.
In order to show existence and uniqueness of solutions of the magnetostatic 
problem we rely on a result about the isomorphism of a simplicial 
cohomology space $H^k_p(K)$ and the $L^p$-cohomology space 
$H^k_{p,dR}(\omegabar)$.
This result was proven in \cite{goldshtein}. In the diploma thesis of Nikolai
Nowaczyk \cite{nowaczyk}, which mostly is based on this paper, 
many additional details can be found. The result will be presented in the
next section. It should be noted that even though the results in 
\cite{goldshtein} are
proved explicitely for smooth manifolds without boundary the results can be 
extended to Lipschitz manifolds with boundary (see the proof of Theorem 2 and 
the remark at the end in \cite{goldshtein}). Therefore, we can apply the result
to our case.










\section{Isomorphism of Cohomology}

% \subsection{Assumptions}
% In order to formulate the assumptions necessary for the result from 
% \cite{goldshtein} to work we will define some basic things from 
% simplicial topology theory. More details and references can be found in 
% \cite[Chapter 4.21]{topology_and_geometry}.
Before we state the theorem about the isomorphism of we will first formulate 
a crucial assumption for this result to hold.


Because $\omegabar$ from our problem is itself a polyhedron we can
assume that $\omegabar$ and $|K|$ are equal as subsets of $\real^n$ and we can
simply use the identity as triangulation.
However, we will use different metrics on $|K|$ and $\omegabar$. 
We use the Euclidian metric on 
$\omegabar$ and we use the standard simplicial metric on $|K|$ (cf. 
\cite[p.191]{goldshtein}). This metric is defined as follows:

Choose some numbering of the vertices $\{ x_1,\, x_2, ... \}$ and
take $f: |K| \rightarrow \ell^2$ where $\ell^2$ is the 
Hilbert space of real-valued square-summable sequences s.t. $f(x_i) = e_i$ 
with $e_i \in \ell^2$ being the standard unit vectors and $f$ is affine on 
every simplex. This mapping is unique.%%%TBD: Proof uniqueness%%%%

Then we define the metric on $|K|$ as the pullback $g_S = f^*g$ 
where $g$ is the standard metric in $\ell^2$. Let $\langle \cdot , 
\cdot \rangle$ be the standard scalar product on $\ell^2$. Then for $x \in |K|$ 
and $\sum_{i=1}^n v_i \frac{\partial}{\partial x_i}, \; 
\sum_{j=1}^n w_j \frac{\partial}{\partial x_j} \in T_x |K|$ we have 
\begin{align*}
g_S|_x\left(\sum_{i=1}^n v_i \frac{\partial}{\partial x_i}, 
\sum_{j=1}^n w_j \frac{\partial}{\partial x_j}\right) &= 
\left\langle \sum_{k=1}^\infty \sum_{i=1}^n v_i 
\frac{\partial f_k}{\partial x_i} (x)
\frac{\partial }{\partial y_k}, 
\sum_{l=1}^\infty \sum_{j=1}^n w_j \frac{\partial f_l}{\partial x_j} (x)
\frac{\partial }{\partial y_l} \right\rangle \\   
&= \sum_{i,j=1}^n \sum_{k,l=1}^\infty v_i \frac{\partial f_k}{\partial x_i} (x)
w_j \frac{\partial f_l}{\partial x_j} (x) 
\left\langle \frac{\partial }{\partial y_k}, \frac{\partial }{\partial y_l} 
\right\rangle\\
&= \sum_{i,j=1}^n \sum_{k=1}^\infty v_i \frac{\partial f_k}{\partial x_i} (x)
w_j \frac{\partial f_k}{\partial x_j} (x)\\
&= \sum_{i,j=1}^n \sum_{k=1}^\infty v_i w_j \left( Df(x)^T Df(x) \right)_{ij} \\
&= v^T Df(x)^T Df(x) w = \left\langle Df(x) v, Df(x) w \right\rangle,
\end{align*}
where $D$ denotes the Jacobian. 
{\color{red} (TBD: This Jacobian as written here would technically be in 
$\real^{\infty \times n}$. Only finitely many lines are non-zero though, 
but this is not quite rigorous yet. )}
%%% TBD: This is only well-defined if x is in the interior of a full simplex.

We have two crucial assumptions on the triangulation for the result to hold 
(cf. \cite[p.194]{goldshtein}). We summarize them under 
\textit{GKS-condition} named after the three authors of \cite{goldshtein}.

\begin{assumption}[GKS-condition]
    We will assume the following on the simplicial complex $K$ 
    and the triangulation $\tau$:
    \begin{enumerate}
    \item The star of every vertex in $K$ contains at most $N$ simplices.
    \item For the differential of $\tau$ we have constants 
        $C_1, C_2 > 0$ s.t.
        \begin{align*}
        \lVert d\tau|_x \rVert < C_1, \; 
        \lVert d\tau^{-1}|_{\tau(x)} \rVert < C_2,
        \end{align*}
        where $d$ denotes the differential in the sense of differential 
        geometry and the norm is the operator norm w.r.t. the metrics on $|K|$ 
        and $\omegabar$.
    \end{enumerate}
\end{assumption}
The first assumption is equivalent to every vertex being contained in
at most $N$ simplices, which is fulfilled if we have a shape regular mesh.\par
%%% TBD: Reference or proof or sth%%%

Because $\tau$ is just the identity in our case 
the second assumption says that for every 
$x \in |K|$
\begin{align*}
\sup\limits_{v \neq 0} \frac{\lVert v \rVert}{\sqrt{g_S|_x(v,v)}} =
\sup\limits_{v \neq 0} \frac{\lVert v \rVert}{\lVert Df(x)v\rVert} < C_1
\end{align*}
and analogously
\begin{align*}
    \sup\limits_{v \neq 0} \frac{\lVert Df(x)v\rVert}{\lVert v \rVert} < C_1.
\end{align*}
%%% TBD: Give more details and interpretation

\subsection{Statement of the Isomorphism} \label{sec_isomorphism_cohomology}

From now on we will assume that the GKS condition is fulfilled.
% The isomorphism of the cohomology spaces from \cite{goldshtein} uses several
% mappings between different cohomology spaces. 

\begin{definition}[Induced map]
    Let $V$ and $W$ be real vector spaces, $X \subseteq V$, $Y \subseteq W$ be 
    subspaces. For a linear map $L: V \rightarrow W$ with $L(X) \subseteq Y$ 
    we define the induced map
    \begin{align*}
        [L]: \faktor{V}{X} \rightarrow \faktor{W}{Y},\,
        [v] \mapsto [Lv].
    \end{align*}     
\end{definition}
It is easy to check that the induced map is well-defined using the
definition of quotient space. %% Proven on the 27.11.2022


The first isomorphism is induced from a linear mapping
from the so called \textit{S-forms} 
$S_p^k(K)$ to \textit{p-summable $k$-cochains} $C_p^k(K)$ which will both 
be defined next.

\begin{definition}
    We define the following norm of a $k$-cochain $f$
    \begin{align*}
    \norm{f}_{C_p^k(K)} \vcentcolon= 
    \left( \sum\limits_{c \, k\text{-chain}} |f(c)|^p \right)^{1/p}.
    \end{align*}
    and the space of \textit{p-summable k-cochains}
    \begin{align*}
    C_p^k(K) \vcentcolon= \{f \, k\text{-cochain} | \,  
    \norm{f}_{C_p^k(K)} < \infty \}.
    \end{align*}
\end{definition}
% Take $\tau, \sigma \in K$ s.t. $\tau$ is a face of $\sigma$ which we write as
% $\tau < \sigma$. It can be shown that the standard embedding 
% $j: \tau \hookrightarrow \sigma$ induces an
% restriction operator 
% $j^*_{\sigma, \tau}:W^*_\infty(\sigma) \rightarrow W^*_\infty(\tau) $ which is 
% bounded (cf \cite[p.191]{goldshtein}). 
% \begin{definition}[S-forms]
%     Let 
%     \begin{align*}
%     \theta = \{ \theta(\sigma) \in W^k_\infty(\sigma) | \sigma \in K\}
%     \end{align*}
%     be a collection of differential $k$-forms. We call $\theta$ S-form of degree
%     $k$ if we have for all simplices
%     $\mu <\sigma$ 
%     \begin{align*}
%     j^*_{\sigma,\mu}\theta(\sigma) = \theta(\mu).
%     \end{align*}
%     We denote with $S^k(K)$ the space of all S-forms of degree $k$ over the chain
%     complex $K$. 
%     For $\theta \in S^k(K)$ we define $d\theta \vcentcolon= \{ d\theta(\sigma) | 
%     \sigma \in K \} \in S^{k+1}(K)$. $S^*(K)$ is the resulting cochain complex.
% \end{definition}
% For $\theta \in S^k(K)$ we now define the norm
% \begin{align*}
% \lVert \theta \rVert _{S_p(K)}  \vcentcolon= \left( \sum_{\sigma \in K} 
% \lVert \theta(\sigma) \rVert _{W^k_\infty(\sigma)}^p \right)^{1/p}.
% \end{align*} 
% $S^k_p(K)$ are the S-forms of degree $k$ s.t. this norm is finite.

% Using integration we can define define the homomorphism 
% (see \cite[p.191]{goldshtein})
% \begin{align*}
% I: S_p^k(K) \rightarrow C_p^k(K), \; I(\theta)(\sigma) = 
% \int_\sigma \theta(\sigma) \text{ for } \sigma \in K.
% \end{align*}
% With the exterior derivative $d$ on S-forms as defined above we define 
% \begin{align*}
%     \mathcal{Z}_p^k &\vcentcolon= \{ \theta \in S^k_p(K) | \, d\theta = 0 \} \\
%     \mathcal{B}_p^k &\vcentcolon= dS^k_p(K)
% \end{align*}
% and then the resulting cohomology space

% \begin{align*}
%     \mathscr{H}_p^k(K) \vcentcolon= 
%     \faktor{\mathcal{Z}_p^k}{\mathcal{B}_p^k}.
% \end{align*}

% We denote the standard cochain cohomology as $H^k_p(K)$. Then we have that the 
% integration mapping
% $I: S_p^k(K) \rightarrow C_p^k(K)$ 
% induces an isomorphism on the cohomologies i.e. 
% $[I]: \mathscr{H}_p^k(K) \rightarrow H^k_p(K)$ is an isomorphism of vector 
% spaces (see Theorem\,1 in \cite{goldshtein}
% and the proof thereof).







% The next step is to obtain an isomorphism between the cohomology 
% of S-forms $\mathscr{H}_p^k(K)$ and the $L_p$ cohomology 
% $\lpcoho(\omegabar)$. At first, we define 
% \begin{align*}
% \varphi: W^k_{\infty,loc}(M) \rightarrow S^k(K), \;
% \omega \mapsto \{ \omega|_\sigma \, |\, \sigma \in K \}.
% \end{align*}
% This is a well-defined vector space isomorphism (\cite[p.191]{goldshtein}). This
% way we can identify $W^k_{\infty,loc}(M)$ with $S^k(K)$.  Using the
% isomorphism $\varphi$ we now define 
% $S^k_p(M) \vcentcolon= \varphi^{-1} S^k_p(K)$.
% It can be shown that $S^k_p(M) \subseteq W^k_p(M)$. Let 
% $\iota: S^k_p(M) \hookrightarrow W^k_p(M)$ be the inclusion operator. 
% The inclusion induces an
% isomorphism on cohomology \cite[Lemma 4, Corollary]{goldshtein} i.e. 
% $[\iota]: \mathscr{H}_p^k(K) \rightarrow \lpcoho(\omegabar)$ is an isomorphism. 


% In conclusion, we get the following isomorphisms of cohomologies:
% \begin{align*}
%     \lpcoho(\omegabar) \xrightarrow{[\iota]^{-1}} \mathscr{H}_p^k(K) 
%     \xrightarrow{[I]} H^k_p(K).
% \end{align*}
% This result will be crucial in the next section to obtain a unique solution
% to our problem.

The idea is that for a $k$-form $\theta$ we have the cochain 
$I(\theta) \in C^k(K)$, $I(\theta)(\sigma) = \int_\sigma \theta$ for any
$k$-simplex $\sigma$. We want to show that this map induces a isomorphism on
cohomology. 


At first, we will discuss when and how this integration mapping is well-defined. 
In order to do so, we will use restriction operatorss that are introduced in
\cite[p.191]{goldshtein}. Let $\sigma, \tau \in K$ be simplices s.t.
$\tau < \sigma$ i.e. $\tau$ is a face of $\sigma$. The pullback of the standard
inclusion mapping $j_{\tau, \sigma}: \tau \hookrightarrow \sigma$ gives us 
a restriction 
$j^*_{\tau, \sigma}: W^k_\infty(\sigma) \rightarrow W^k_\infty(\tau)$, but 
we have to check whether this is well-defined. In order to do so, take 
some $\eta \in W^k_\infty(\sigma)$. Before restriction we extend $\eta$ to 
a neighborhood $U \supseteq \sigma$ in the affine hull of $\sigma$ to 
get $\tilde{\eta} \in W^k_\infty(U)$. Then we set 
$j^*_{\tau, \sigma} \eta = j^*_{\tau, U}$ which is now well-defined and 
independent of the extension $\tilde{\eta}$ chosen. It should be stressed 
that this construction does not work for $W^k_p$ with $p < \infty$. 


Now take $\eta \in W^k_{\infty,loc}(\omegabar)$. By applying this restriction
operator repeatedly we can now find $\eta_\sigma \in W^k_\infty(\sigma)$ for 
every $\sigma \in K$. Then we define 
\begin{align*}
    (I\eta) (\sigma) = \int_\sigma \eta_\sigma 
    \text{ for all $k$-simplices } \sigma \in K .
\end{align*}
So we have established that $I: W^k_{\infty,loc}(\omegabar) \rightarrow C^k(K)$ 
is well-defined.


In the next step, we will use two operators $\rop$ and $\aop$ from 
\cite{goldshtein}.
The precise definition and details of their construction
are not relevant for our purposes because we will only use
the following properties (cf. \cite[Thm.2]{goldshtein}).

\begin{theorem}\label{operators}
    Assume that the triangulation $\tau$ fulfills the GKS-condition.
    Then there exist linear mappings 
    $\mathscr{R}: L^k_{1,loc}(\omegabar) \rightarrow 
    L^k_{1,loc}(\omegabar)$, $\mathscr{A}: L^k_{1,loc}(\omegabar) 
    \rightarrow L^{k-1}_{1,loc}(\omegabar)$ 
    such that
    \begin{enumerate}
        \item $\mathscr{R}\omega - \omega = 
            d\mathscr{A}\omega + \mathscr{A}d\omega$ for 
            $\omega \in W^k_{1,loc}(\omegabar)$
        \item for any $1 \leq p \leq \infty$, 
            $\rop(W^k_p(\omegabar)) \subseteq S^k_p(\omegabar)$.
    \end{enumerate}
\end{theorem}
where
\begin{align*}
    S^k_p(\omegabar) = \{ \eta \in W^k_{\infty,loc} | \, 
    I\eta \in C^k_p(K)\}.
\end{align*}

Now define $\bar{I} \vcentcolon= I \circ \rop$. This gives a well-defined 
mapping from $W^k_p(\omegabar)$ to $C^k_p(K)$. Following the arguments of 
\cite{goldshtein} and using the properties of $\rop$ and $\aop$ one can show 
that the induced homomorphism of cohomologies 
$[\bar{I}]: H^k_{p,dR}(\omegabar) \rightarrow H^k_p(K)$ is an isomorphism.
This isomorphism will play a crucial part in the proof of uniqueness and 
existence of solutions in the next section.


\section{Existence and uniqueness of solutions}

\subsection{Reformulation of the problem} 

We will return now to the magnetostatic problem. In order to use the results
above we will reformulate the problem in the notation of differential forms.
There are two ways to identify a vector field with a differential form 
(cf. \cite[Table 6.1 and p.70]{arnold}) either as a 1-form or a 2-form. 
For a vector field $B$ we define
\begin{align*}
    F^1\, B &\vcentcolon= B_1 \, dx_1 + B_2 \, dx_2 + B_3\, dx_3 \text{ and}\\
    F^2\, B &\vcentcolon= B_2 \, dx_2 \wedge dx_3 - B_2 \, dx_1 \wedge dx_3
        + B_3 \, dx_1 \wedge dx_2
\end{align*} 
as the corresponding 1-form and 2-form. 
Then the exterior derivative is $dF^2\,\omega$ corresponds to the divergence,
the codifferential $\delta F^2\,\omega$ 
corresponds to the curl and the normal component
being zero on the boundary corresponds 
to $\omega \in \mathring{H}^2(d)$.\cite{}. 

If we then use the association of
3-forms with scalars we have the corresponding boundary value problem without
the integral condition for 
2-forms: Find $\omega \in \mathring{H}^2(d)$ s.t.
\begin{align}
    \delta \omega &= 0, \\ 
    d\omega  &= 0 \text{ in } \Omega.
\end{align}
Next, we have to add the integral condition. 
We use that we are in three dimensions so
$**=(-1)^{k(n-k)}\tilde{\nu} = \tilde{\nu}$ \cite[p.66]{arnold} for any
$k$-form $\tilde{\nu}$.
and observe
\begin{align*}
    *F^2 \, B  &= B_1 \, **dx_1 + B_2 \, **dx_2 + B_3\, **dx_3 
        = B_1 \, dx_1 + B_2 \, dx_2 + B_3\, dx_3\\ 
    &= F^1 \, B.
\end{align*}
Then we have 
\begin{align*}
    \int_\gamma * F^2\, B = \int_\gamma F   ^1\, B = \int_\gamma B \cdot \text{d}l.
\end{align*}
In the last step we used the fact that the integration of a 1-form over a
curve is equivalent to the curve integral of the associated vector field
(cf. \cite[Sec. 6.2.3]{arnold}). Hence, we can add the integral condition 
\begin{align}
    \int_\gamma *\omega = C_0 \label{integral_condition}.
\end{align}
However, we have  only $\omega \in \mathring{H}_0^2(d,\delta)$ so 
$*\omega \in H^1(\delta)$ so this integral might not be well defined. In order 
to deal with this, we will again use the operator $\rop$ and $\bar{I}$ from 
Sec.\,\ref{sec_isomorphism_cohomology}. Instead of using 
(\refeq{integral_condition}) directly we use the condition 
\begin{align*}
    \int_\gamma \rop * \omega = C_0.
\end{align*}
This is equivalent to $(\bar{I}*\omega)(\gamma) = C_0$. We know that this is 
well-defined. 


We want to give some justification about why this is a reasonable extension.
For any closed $\eta \in W^1_p(\omegabar)$ we have $\rop \eta = \eta - 
d\aop\eta$ from Thm.\,\ref{operators}. For smooth 
$\phi \in \Lambda^0(\omegabar)$ we immediately get from the standard Stoke's 
theorem that $\int_c d\phi = 0$ for all closed $1$-chains $c$. If we 
assume sufficient regularity on $\rop \eta$, $d\aop\eta$ and $\eta$ 
then we would have indeed 
\begin{align*}
    \int_\gamma \rop \eta = \int_\gamma \eta - d\aop\eta = \int_\gamma \eta.
\end{align*}

\begin{remark}
    This justification can be done more rigorously with the help of S-forms
    (cf. \cite{goldshtein}) which correspond to $W_{\infty,loc}(\omegabar)$
    with an additional decaying condition. Then we obtain that the integral 
    is consistent with the integral on these S-forms.
\end{remark}
\noindent To summarize we obtain the following problem.

\begin{problem}
    Find $\omega \in \mathring{H}^2(d;\Omega)$ s.t.
    \begin{align*}
        d \omega &= 0, \\
        \delta \omega &= 0 \text{ in $\Omega$}, \\
        (\bar{I}\omega)(\gamma)  &= C_0.
    \end{align*}
\end{problem}
\noindent We will examine existence and 
uniqueness of this problem in the next section.

% In the problem, we have the additional constraint 
% \begin{align*}
%     \int_\gamma B \cdot \text{d}l = C_0
% \end{align*}
% for some $C_0 \in \real$ and a closed bounded triangulated curve $\gamma$.
% This corresponds in the language of differential forms 
% to the integration of a $1$-form $\omega$
% over a $k$-chain $\gamma$
% \begin{align*}
%     \int_\gamma \omega  = C_0.
% \end{align*}
% However, we only assume 
% $\omega \in \mathring{H}^k(d;\Omega)$ so we have to check if and how this can
% be well defined.

% Above, we introduced the integral operator $I$ for $S^k_p(K)$ which can 
% therefore be applied on $\omega \in S^k_p(\omegabar)$ as
% \begin{align*}
%     I(\omega) \vcentcolon= I (\varphi(\omega)).
% \end{align*}
% \noindent If we fix now the closed 
% $k$-chain $\gamma$ then $I(\cdot)(\gamma) = \int_\gamma$ becomes a functional on
% $S^k_p(\omegabar)$, but it is a-priori not clear how to extend this to closed forms in
% $W_p^k(\omegabar)$. 

% We know that $\int_\gamma d\eta = 0$ for $\eta \in S^{k-1}_p(\omegabar)$ because 
% otherwise $I$ would not induce an isomorphism on cohomology. We extend this now
% by setting $\int_\gamma d\nu = 0$ for all $\nu \in W^{k-1}_p(\omegabar)$. 
% We have to check whether this is consistent with the definition above i.e. we
% have to show that if $d\nu \in S^k_p(M)$ for some 
% $\nu \in W_p^{k-1}k(\omegabar)$ then 
% it must follow from the previous definition of the integral that indeed
% \begin{align*}
%     \int_\gamma d\nu = 0
% \end{align*}
% holds.
% Let $A \subseteq M$ be a bounded neighborhood of $\gamma$. We can then find 
% $\tilde{\nu}$ s.t.  $\tilde{\nu} \in W^{k-1}_q(A)$ for any $q > 1$ and 
% $d\tilde{\nu} = d\nu$ \cite[Thm 3.1.1]{schwarz}. Now it is possible to apply 
% Stoke's theorem \cite[Thm. 9]{goldshtein_integration} to get  
% $\int_\gamma d\nu = 0$ and consequently we have shown consistency.


% In order to extend the functional $\int_\gamma$ 
% further we will use two operators
% $\mathscr{R}$ and $\mathscr{A}$ which are constructed in the second section 
% of \cite{goldshtein}. The precise definition and details of their construction
% are not relevant for our purposes because we will only use
% the following properties (cf. \cite[Thm.2]{goldshtein}).

% \begin{theorem}\label{operators}
%     Assume that the triangulation $\tau$ fulfills the GKS-condition.
%     Then there exist linear mappings $\mathscr{R}: L^k_{1,loc} \rightarrow 
%     L^k_{1,loc}$, $\mathscr{A}: L^k_{1,loc} \rightarrow L^{k-1}_{1,loc}$ 
%     such that
%     \begin{enumerate}
%         \item $\mathscr{R}\omega - \omega = 
%             d\mathscr{A}\omega + \mathscr{A}d\omega$ for 
%             $\omega \in W^k_{1,loc}(\omegabar)$
%         \item for any $1 \leq p \leq \infty$, 
%             $\rop(W^k_p(\omegabar)) \subseteq S^k_p(\omegabar)$.
%     \end{enumerate}
% \end{theorem}

% \noindent We can now use the operator $\rop$ to define $\int_\gamma \omega$ for closed
% $\omega \in W^k_p(M)$ as
% \begin{align*}
% \int_\gamma \omega \vcentcolon= \int_\gamma \rop\omega.
% \end{align*}
% This is consistent with the curve integral for S-forms 
% because if $\omega \in S^k_p(M)$ closed then due to 
% Thm.\,\ref{operators}
% \begin{align*}
% \int_\gamma \rop\omega = 
% \int_\gamma \omega + d\mathscr{A}\omega + \mathscr{A}d\omega = 
% \int_\gamma \omega.
% \end{align*}

\subsection{Existence and uniqueness}

We start with the following
\begin{proposition}\label{uniqueness_cochain}
    Let $\gamma$ be a closed $k$-chain s.t. the homology class $[\gamma]$ 
    spans the homology space $H^k_c$. Then for any $C_0 \in \real 
    \setminus \{0\}$ 
    if we have closed cochains $F,G$ s.t.
    \begin{align*}
    F(\gamma) = G(\gamma)= C_0
    \end{align*}
    then $[F] = [G]$ i.e. their cohomology classes are equal.
\end{proposition} 
\begin{proof}
    From \cite[Sec. 2.5]{arnold} we know that 
    $\text{dim}\,H^k(K) = \text{dim}\,H^k_c$. Because $F$ and $G$ are closed we
    therefore have $\lambda_F, \lambda_G \in \real$ and a cohomology class 
    $[b]$ s.t.
    $[F] = \lambda_F [b]$ and $[G] = \lambda_G [b]$. This is 
    equivalent to the existence of $(k-1)$-cochains $J_F,J_G$ s.t. 
    \begin{align*}
        F = \lambda_F b + \delta J_F \text{ and } G = \lambda_G b + \delta J_G.
    \end{align*}
    so 
    \begin{align*}
        0 \neq \lambda_F b(\gamma) + \delta J_F(\gamma) = F(\gamma) = G(\gamma)
        = \lambda_G b(\gamma) + \delta J_F(\gamma).
    \end{align*}
    Because $\gamma$ is closed we have for any $(k-1)$-chain $J$, 
    $\delta J(\gamma) = J(\partial \gamma) = 0$ and so we arrive at
    $\lambda_F = \lambda_G$ i.e. $[F] = [G]$.
\end{proof}





We are now able to proof existence of a 
solution. Take a closed cochain $F \in C^1_2(K)$ s.t. $F(\gamma) = C_0$ 
and 
$F(\partial d) = 0$ for any $2$-chain $d$ 
as in Prop.\,\ref{uniqueness_cochain}. Then we know from 
Sec.\,\ref{sec_isomorphism_cohomology} that 
there exists a unique $[\theta] \in \mathscr{H}_2^1(K)$ s.t. 
$[I]([\theta]) = [F]$. Let us take the 1-form $\eta \vcentcolon= 
\varphi^{-1} \theta \in W^1_2(\omega)$. Then $\int_\gamma \eta = C_0$ holds. 
Because we need a 2-form we will take a closer look at $*\eta$.
We have that the Hodge star operator $*: L^1_2(\Omega) \rightarrow 
L^2_2(\Omega)$ is a Hilbert space isometry. 
%%% TBD: Add proof, already written down on 26.11.2022


First we compute
\begin{align*}
    \delta *\eta = (-1)^{n(k-1)+1} *d**\eta = (-1)^{n(k-1)+1} *d\eta = 0.
\end{align*}
Using the Hodge decomposition for unbounded domains 
(cf. \cite[Lemma 1]{picard}) we get therefore that there exists 
a sequence  $(\phi_i)_{i\in \mathbb{N}} \subseteq H^3(\delta,\Omega)$ 
and a harmonic $\omega \in \mathring{H}^2(d) \cap H^3(\delta)$ s.t. 
\begin{align*}
    *\eta = \lim\limits_{i \rightarrow \infty} \delta \phi_i + \omega.
\end{align*}
where the limit is in $L^1_2(\Omega)$. 


We will show that $\omega$ is then a solution. Because $\omega$ is harmonic
we already know that $d\omega = 0$, $\delta \omega = 0$ and 
$\omega \in \mathring{H}^2(d)$. It remains to show that the integral condition
(\refeq{integral_condition}) is also satisfied.

At first we check that the integral is well-defined. We have $\delta \omega = 0$
which implies
\begin{align*}
    d * \omega = ** d*\omega = (-1)^{n(k-1)+1} *\delta \omega = 0
\end{align*}
so $*\omega$ is a closed 1-form. Therefore the integral is well-defined as shown
in Sec.\,\ref{well_definedness_integral}.

Take a ball of radius $R>0$ 
around the origin with $R$ large enough s.t. $\gamma \subseteq B_R$. 
Using the fact that the range of $\delta$ is closed on bounded domains 
(cf. \cite[Lemma 7]{picard}) there is some $\phi_R \in H^3(\delta;B_R)$ s.t.
\begin{align*}
    *\eta|_{B_R} = \omega|_{B_R} + \delta \phi_R.
\end{align*}
We then get for the integral condition (\ref{integral_condition}) 
\begin{align*}
    \int_\gamma *\omega &= \int_\gamma *\omega|_{B_R} = 
    \int_\gamma *(*\eta|_{B_R} - \delta \phi_R) = 
    \int_\gamma \eta|_{B_R} - (-1)^{3\cdot 2+1} d * \phi_R \\
    &= \int_\gamma \eta|_{B_R} = C_0
\end{align*}
so the integral condition (\refeq{integral_condition}) is fulfilled and 
$\omega$ is indeed a solution. \newline
{\color{red} TBD: Put all this in a theorem.}

% If we now take the Hodge decomposition
% $L^2_2(\omegabar) = \bar{\mathfrak{B^k}} \oplus \mathcal{H}^k \oplus
% \bar{\mathfrak{B^*_k}}$ and define $\omega$ as the projection of $\eta$ onto the
% harmonic forms $\mathcal{H}^k$. Then we know that $d\omega = 0$, 
% $\delta\omega = 0$ and $\text{tr}\,\omega = 0$. So we only have to show that
% \begin{align*}
% \int_\gamma \omega = C_0.
% \end{align*}

% We know from the Hodge decomposition that there exists a sequence
% $(\phi_i)_{i\in \mathbb{N}} \subseteq L^{k-1}_2(M)$ s.t. 
% $\omega = \eta - \lim_{i \rightarrow \infty} d\phi_i$.
% Let now be $R>0$ large enough s.t. $\gamma \subseteq B_R$. Then we know that
% $d W^{k-1}_2(B_R)$ is closed in $L_2^k(B_R)$. \cite{}  Therefore there exists 
% $\phi_R \in  W^{k-1}_2(B_R)$ s.t. 
% $\lim_{i \rightarrow \infty} d\phi_i|_{B_R} = d\phi_R$. So we have
% $\omega|_{B_R} = \eta|_{B_R} - d\phi_R$ and 
% \begin{align*}
% \int_\gamma \omega = \int_\gamma \omega|_{B_R} = \int_\gamma \eta|_{B_R} = C_0.
% \end{align*}
% This proves existence.

\begin{theorem}
    The solution of the problem is unique.
\end{theorem}
\begin{proof}
    Let $\omega, \tilde{\omega}$ both be solutions. 
    Because  $*\omega$ and
    $*\tilde{\omega}$ are closed the cochains 
    $c\mapsto \int_c \rop*\omega$ and 
    $c\mapsto \int_c \rop*\tilde{\omega}$ are closed.
    
    Due to $\int_\gamma \rop *\omega = \int_\gamma \rop *\tilde{\omega}$ and the 
    assumption that $[\gamma]$ spans the homology space we have with 
    Prop.\,\ref{uniqueness_cochain} 
    $[I(\rop *\omega)] = [I(\rop *\tilde{\omega})]$
    and because $[I]$ is an isomorphism 
    $[\rop *\omega] = [\rop *\tilde{\omega}]$. Hence,
    \begin{align*}
    [*\tilde{\omega}] = [\rop *\tilde{\omega}] = 
    [\rop *\omega] = [*\omega].
    \end{align*}
    That is equivalent to the
    existence of some $0$-form $\phi \in H^0(d)$ s.t.
    $*\omega = *\tilde{\omega} + d\phi$. We continue by applying the Hodge
    star operator to both sides and use the definition of the codifferential 
    $\delta$:
    \begin{align*}
        \omega = \tilde{\omega} + *d\phi = \tilde{\omega} + *d**\phi 
        = \tilde{\omega} + (-1)^{(n-k)(k-1)+1}\delta * \phi.
    \end{align*}
    Then because $\omega$ and 
    $\tilde{\omega}$ are harmonic we have 
    $\omega, \tilde{\omega} \perp \delta H^{3}(\delta)$ and therefore 
    \begin{align*}
    \omega = \tilde{\omega}.    
    \end{align*}
\end{proof}
If we now translate this back to standard vector calculus terms we have found 
the unique solution of the homogeneous magnetostatic on our domain $\Omega$.

% \section{Application: Homogeneous magnetostatic problem on the 
% exterior domain of a torus}

% As an application of this general boundary value problem we will have a look
% at the following magnetostatic problem. Let $\Omega$ be the exterior domain of
% a triangulated torus i.e. $\real^3 \setminus \Omega$ is a torus with 
% triangulated surface. Let $B$ be the magnetic field. We then have the following
% boundary value problem:
% %%%TBD: Include a picture
% It is natural to identify the magnetic field $B$ with a 2-form $\omega$.
% Then the exterior derivative is $d\omega$ corresponds to the divergence,
% the codifferential $\delta$ corresponds to the curl and the normal component
% being zero is corresponds to $\omega \in \mathring{W}^2_2(\Omega)$.\cite{}. 
% The curve integral is an integration over a one-dimensional manifold and
% corresponds therefore to the integration of a one-form. Therefore the
% condition \ref{curve_integral_contition} is can be expressed with the hodge 
% star operator $*$ as
% \begin{align*}
%     \int_\gamma *\omega = C_0.
% \end{align*}


% Now we want to apply our previous results.
% $\Omega$ fulfills all required assumptions for the domain. Because $\gamma$
% goes around the torus once and the homology space $H^1_c$ is one-dimensional
% {\color{red}(TBD: This has to be referenced or proven)}. Therefore because 
% $\gamma$ is not a boundary $[\gamma]$ spans $H^1_c$. Now all assumptions are
% fulfilled and we can apply our result. We will do so on 1-forms and transfer the
% result to 2-forms using the Hodge star operator.

% \subsection*{Existence}
% Let 
% $\tilde{\omega} \in \mathring{W}^1_2(\Omega) $ be the unique solution of our 
% general problem \ref{} and define $\omega \vcentcolon= *\tilde{\omega}$. Then
% we use $**=(-1)^{k(n-k)}\tilde{\omega} = \tilde{\omega}$ \cite[p.66]{arnold} 
% to get 
% \begin{align*}
%     d\omega = ** d*\tilde{\omega} = * (-1)^{n(k-1)+1} \delta \tilde{\omega}
%     = 0
% \end{align*}
% and
% \begin{align*}
%     \delta \omega = (-1)^{n(k-1)+1} *d*\omega = (-1)^{n(k-1)+1}* d\tilde{omega}
%     = 0.
% \end{align*}



%%% TBD: Nowaczyk's thesis is not a master's thesis
\printbibliography
\end{document}