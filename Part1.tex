\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{xcolor}
\usepackage{csquotes}
\usepackage{enumerate}
\usepackage{faktor}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{showlabels}

\usepackage{biblatex}
\addbibresource{bibliography.bib}
% \bibliography{bibliography}
% \bibliographystyle{ieeetr}

\numberwithin{equation}{subsection}

\newtheorem{lemma}{Lemma}[section]
\numberwithin{lemma}{subsection}
\newtheorem{proposition}[lemma]{Proposition}
\newtheorem{theorem}[lemma]{Theorem}

\theoremstyle{definition}
\newtheorem{assumption}[lemma]{Assumption}
\newtheorem{definition}[lemma]{Definition}
\newtheorem{remark}[lemma]{Remark}
\newtheorem{problem}[lemma]{Problem}

\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator{\curl}{curl}
\DeclareMathOperator{\diver}{div}

\newcommand{\aop}{\mathscr{A}}
\newcommand{\alternating}[2]{ {\text{Alt}^{#1}\,#2} }
\newcommand{\integers}{\mathbb{Z}}
\newcommand{\smoothcompforms}[2]{C_0^\infty \Lambda^{#1}(#2)}
\newcommand{\lpcoho}{H^k_{p,dR}}
\newcommand{\naturalnum}{\mathbb{N}}
\newcommand{\norm}[2]{\lVert #1 \rVert_{#2}}
\newcommand{\omegabar}{\overline{\Omega}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\rop}{\mathscr{R}} % short for R operator


\begin{document}

\section{Differential forms}

Our goal is to study the homogeneous magnetostatic problem on the exterior 
domain of a triangulated torus. That means 
that for the unbounded domain  $\Omega \subseteq \real^3$ we have
$\real^3 \setminus \Omega$ is a triangulated torus. We also need a 
piecewise straight (i.e. triangulated) closed curve around the torus.
%%% TBD: Picture
{\color{red} (TBD: Define the "triangulated torus" more rigorous)}

Let $B$ be a magnetic field on the domain $\Omega$.
We the have the following boundary value problem:

\begin{align}
    \curl \, B &= 0, \\ 
    \diver \, B  &= 0 \text{ in } \Omega \\
    B \cdot n &= 0 \text{ on } \partial \Omega \text{ and }\\
    \int_\gamma B \cdot dl &= C_0
\end{align}
where $n$ is the outward normal vector field on $\partial \Omega$ and 
$C_0 \in \real$. We want to prove existence and uniqueness of 
solutions. In order to do so we will need to introduce Sobolev spaces of 
differential forms and basics from
simplicial topology {\color{red} among other things...}

At first, let us introduce some basic notions about differential forms. 
We follow the brief introduction given by Arnold (cf. \cite[Sec. 6.1]{arnold}), 
but less details will be given. 

\subsection{Alternating maps}

Let $V$ be a real vector space with $\text{dim}\,V = n$ 
    and $\text{Alt}^k\,V$ be the 
space of $k$-alternating maps from $V^k$ to $\real$. For $\omega \in 
\alternating{k}{V}$, $\mu \in 
\alternating{l}{V}$ we define the wedge product $\omega \wedge \mu \in 
\alternating{k+l}{V}$ 
\begin{align*}
    (\omega \wedge \mu) (v_1,...,v_k,v_{k+1},...,v_{k+l}) =
    \sum\limits_{\substack{i_1 < ... < i_k \\ i_{k+1} < ... < i_{k+l}}}
    \text{sgn}(i_1,...,i_{k+l}) \omega(v_{i_1},...,v_{i_k}) 
    \nu(v_{i_{k+1}},...,v_{i_{k+l}})
\end{align*}
where $\text{sgn}(i_1,...,i_{k+l})$ is the sign of the permutation 
$(1,...,k+l) \mapsto (i_1,...,i_{k+l})$. This definition is not very intuitive.
{\color{red} TBD: Examples in 3D}.

Let $\{ u_i\}_{i=1}^n$ be any basis of $V$ and $\{ u^i\}_{i=1}^n$ the 
correspoding dual basis. Then 
\begin{align*}
    \{u^{i_1} \wedge u^{i_2} \wedge ... \wedge u^{i_k} | \, 
    1 \leq i_1 < ... < i_k \leq n \}
\end{align*}
is a basis of $\alternating{k}{V}$. In particular, 
$\dim\, \alternating{k}{V} = \binom{n}{k}$.

Given a inner product $\langle\cdot, \cdot \rangle_V$ on $V$ we obtain an inner 
product on $\alternating{k}{V}$ by defining
\begin{align*}
    \langle u^{i_1} \wedge u^{i_2} \wedge... \wedge u^{i_k}, 
    u^{j_1} \wedge... \wedge u^{j_k} \rangle_{\alternating{k}{V}} 
    \vcentcolon= \det \left[ ( \langle u_{i_k}, u_{i_l} \rangle_V )_
    {1\leq k,l \leq n} \right] 
\end{align*}
which is then extended to all of $\alternating{k}{V}$ by linearity. 
We denote with $\lVert \cdot \rVert _\alternating{k}{V}$ the induced norm.
From this definition it follows directly that for a orthonormal basis 
$b_1$,..., $b_n$ the corresponding basis 
$b^{i_1} \wedge b^{i_2} \wedge ... \wedge b^{i_k}$, 
$1\leq i_1 < ... < i_k \leq n$ is an orthonormal basis of $\alternating{k}{V}$.


$\alternating{n}{V}$ is one-dimensional and so we have to choose a basis.
We say that two orthonormal bases of $V$ 
have the same orientation if the change of basis has positive determinant. 
That divides the orthonormal bases into two classes with different orientation.
We choose one of these classes and call these orthonormal bases positively
oriented. In $\real^n$, the convention is to define the class as 
positively oriented which includes the standard orthonormal basis.
Take $\omega \in \alternating{n}{V}$. Then 
$\omega(b_1,...,b_n)$ is the same for any positively oriented orthornormal
basis. We now define the \textit{volume form} vol $\in \alternating{n}{V}$ by requiring
it to be $1$ on all positively oriented orthonormal bases. Using this volume 
form we can now define the \textit{Hodge star operator} 
$*: \alternating{k}{V} \rightarrow \alternating{n-k}{V}$ via the property 
\begin{align*}
    \omega \wedge \mu = \langle *\omega, \mu \rangle_{\alternating{n-k}{V}} 
    \text{vol}
    \quad \forall \omega \in \alternating{k}{V} , \, 
    \mu \in \alternating{n-k}{V}.
\end{align*}
The Hodge star is an isometry, we have $** = (-1)^{k(n-k)}\text{Id}$ and 
\begin{align*}
    \omega \wedge *\mu = \langle \omega, \mu \rangle_{\alternating{k}{V}} 
    \text{vol} \quad \forall \omega, \mu \in \alternating{k}{V}.
\end{align*}
In particular in $\real^3$, we have $** = \text{Id}$ i.e. $*$ is self-inverse.


Now we will move on to differential forms. We will mostly deal with the
case $V = \real^n$ and denote $\text{Alt}^k\,\real^n$ just as $\text{Alt}^k$.
Let $\Omega \subseteq \real^n$ be a Lipschitz domain and denote the space 
of differential forms of degree $k$ on $\Omega$ as $\Lambda^k(\Omega)$.
We extend the Hodge star operator to differential forms 
$*: \Lambda^k(\Omega) \rightarrow \Lambda^{n-k}(\Omega)$ simply by applying it 
pointwise.


Then
we define the $L_p$-norm of a $k$-form $\omega$ for $1\leq p < \infty$
as (cf. \cite{goldshtein})
\begin{align*}
\lVert \omega \rVert _{L_p^k(\Omega)}\vcentcolon=
\left(\int_\Omega \lVert \omega(x) \rVert _{\text{Alt}^k}^p \,dx \right)^{1/p}
\end{align*}
%%% TBD: Is this independent of coordinates i.e. does this notation make sense?
and for $p=\infty$ as
\begin{align*}
\esssup_{x\in \Omega} \, \lVert \omega(x) \rVert _{\text{Alt}^k}.
\end{align*}
$L_p^k(\Omega)$ are the spaces of $k$-forms 
s.t. the corresponding $L_p$-norm is finite.
For $p=2$ we obtain a Hilbert space (cf. \cite[Sec. 6.2.6]{arnold}) 
with the $L_2$ inner product  
\begin{align}
\langle \omega, \nu \rangle \vcentcolon= 
\int_\Omega \langle \omega(x), \nu(x) \rangle _{\text{Alt}^k} \,dx. 
\label{def_inner_product}
\end{align}
\begin{proposition}
    The Hodge star operator $*:L^k_2(\Omega) \rightarrow L^{n-k}_2(\Omega)$ is a
    Hilbert space isometry.
\end{proposition}
\begin{proof}
    This follows directly from the definition of the inner product 
    (\refeq{def_inner_product}) and the fact that $*$ is an isometry 
    when applied to alternating forms $\text{Alt}^k$.
\end{proof}


Our next goal is to extend the exterior derivative $d$ 
of smooth differential forms in the weak sense (cf. \cite{goldshtein}). 
Let $\mathring{d}: L^k_2(\Omega) \rightarrow L^{k+1}_2(\Omega)$ be the exterior
derivative as an unbounded operator with domain 
$D(\mathring{d}) = \smoothcompforms{k}{\Omega}$ 
which are the smooth compactly supported differential forms of degree $k$. 
Analogous, let 
$\mathring{\delta}: L^k_2(\Omega) \rightarrow L^{k-1}_2(\Omega)$ be the 
codifferential operator $\mathring{\delta} \vcentcolon= 
(-1)^{n(k-1)+1}*\mathring{d}*$ also with domain $\smoothcompforms{k}{\Omega}$.

Then the exterior derivative $ d\omega \in L^p_{k+1}(\Omega)$ is defined as
the unique $(k+1)$-form in $L^p_{k+1}(\Omega)$ s.t. 
\begin{align*}
\int_\Omega d\omega \wedge *\phi = \int_\Omega \omega \wedge 
*\mathring{\delta}\phi
\quad \forall \phi \in C_0^\infty \Lambda^{k}(\Omega).
\end{align*}
Just as in the usual Sobolev setting we define the following spaces:
\begin{align*}
W^k_p(\Omega) &= \left\{ \omega \in L^k_p(\Omega)\, | 
    \, d\omega \in L_p^{k+1}(\Omega) \right\}, \\ 
W^k_{p,loc}(\Omega) &= \left\{ \omega \ k \text{-form} \, | \,
\omega|_A \in W^k_p(A) \text{ for every open } A \subseteq \Omega 
\text{ s.t. } \overline{A} \subseteq \Omega \text{ is compact} %TBD: Check that this is right
\right\}.
\end{align*}
For $\omega \in W^k_p(\Omega)$ for $p<\infty$ we define the norm 
\begin{align*}
\lVert \omega \rVert _{W^k_p} &\vcentcolon= 
\left( \norm{\omega}{L^k_p}^p + \norm{d\omega}{L^k_p}^p \right)^{1/p}
\end{align*}
and for $p=\infty$
\begin{align*}
    \lVert \omega \rVert _{W^k_\infty} &\vcentcolon= 
    \max\left\{ \norm{\omega}{L^k_\infty},\, \norm{d\omega}{L^k_\infty}
    \right\}.
\end{align*}
    
\begin{definition}[$L^p$-cohomology]
    We define the following subspaces of $W^k_p(\Omega)$, $1\leq p \leq\infty$:
    \begin{align*}
        \mathfrak{B}_k &\vcentcolon= dW^{k-1}_p(\Omega) \text{ and} \\
        \mathfrak{Z}_k &\vcentcolon= \{ \omega \in W^k_p(\Omega)| 
        \, d\omega = 0\}.
    \end{align*}
    We call the $k$-forms in $\mathfrak{B}_k$ exact and the forms in 
    $\mathfrak{Z}_k$ closed. Because $d \circ d=0$ we always have  
    $\mathfrak{B}_k \subseteq \mathfrak{Z}_k$.
    Then we define the de Rham- or $L^p$-cohomology space $\lpcoho(\Omega)$ as 
    the quotient space
    \begin{align*}
        \lpcoho (\Omega) \vcentcolon= \faktor{\mathfrak{Z}_k}{\mathfrak{B}_k}.
    \end{align*}
\end{definition}
\vspace{0.5cm}
We want to examine the Hilbert space $L^k_2(\Omega)$ more closely
(see \cite[Sec. 6.2.6]{arnold} for more details).  
%%% TBD: This is only for bounded domains. What changes?
% Picard defines it as completion of smooth functions \cite[p.37]{picard}
We denote $H^k(d;\Omega) \vcentcolon= W^k_2(\Omega)$. If the domain is clear
we will leave it out. Note that the above definition of the exterior derivative
is in the Hilbert space setting equivalent to defining $d$ as the adjoint
of $\mathring{\delta}$. 



In order to extend $\mathring{\delta}$ as well, we will need the following

\begin{definition}[Codifferential operator]
    Analogous to the smooth case, 
    we define the \textit{codifferential operator} for any $k$ as an unbounded
    operator $\delta: L^k_2(\Omega) \rightarrow L^{k-1}_2$ as
    \begin{align*}
        \delta \vcentcolon= (-1)^{n(k-1)+1}*d*
    \end{align*}
    with domain
    \begin{align*}
        D(\delta) = \{ \omega \in L^k_2(\Omega) | \,
        *\omega \in H^{n-k}(d) \} 
        =\vcentcolon H^k(\delta; \Omega).
    \end{align*}
\end{definition}

\begin{proposition}
    $\delta = \mathring{d}^*$ i.e. $\delta$ is the adjoint of $\mathring{d}$.
\end{proposition}
\begin{proof}
    Denote with
    $D(\mathring{d}^*) \subseteq L_2^{k-1}(\Omega)$ the domain of the adjoint.
    Now take $\omega \in H^k(\delta)$ and $\phi \in 
    \smoothcompforms{k}{\Omega}$.
    Then 
    \begin{align*}
        &\langle \delta \omega, \phi \rangle = 
        (-1)^{nk+1} \langle *d* \omega, \phi \rangle \\  
        &= (-1)^{nk+1} (-1)^{k(n-k)} \langle d* \omega, *\phi \rangle =
        (-1)^{nk+1} (-1)^{k(n-k)} 
            \langle * \omega, \mathring{\delta}*\phi \rangle \\
        &= (-1)^{nk+1} (-1)^{k(n-k)} (-1)^{n(n-k-1)+1}
            \langle * \omega, *\mathring{d}**\phi \rangle \\
        &=(-1)^{n(n-1)+2} (-1)^{k(n-k)} \langle \omega, \mathring{d}**\phi \rangle\\
        &= \langle \omega, \mathring{d}\phi \rangle
    \end{align*}
    where we used repeatedly that $*$ is an isometry and 
    $** = (-1)^{k(n-k)}\text{Id}$. This shows that $H^{k+1}(\delta) \subseteq 
    D(\mathring{d}^*)$ and that $\mathring{d}^* \omega = \delta \omega$. Now for 
    the other inclusion assume that $\omega \in D(\mathring{d}^*)$ and take 
    $\phi \in \smoothcompforms{n-k}{\Omega}$ arbitrary.
    \begin{align*}
        \langle *\omega, \mathring{\delta}\phi \rangle = \pm 
        \langle \omega, \mathring{d}*\phi \rangle = 
        \pm \langle \mathring{d}^* \omega, *\phi \rangle = 
        \pm \langle *\mathring{d}^* \omega, \phi \rangle.
    \end{align*} 
    Here we use $\pm$ to mean that we choose the sign correctly, s.t. all the
    operations are correct. Then by choosing the sign appropriately we find that
    $ \pm *\mathring{d}^* \omega = d*\omega$ and therefore 
    $*\omega \in H^{n-k-1}(d)$ so we proved $D(\mathring{d}^*) \subseteq 
    H^{k+1}(\delta)$ and we are done.    
\end{proof}

In order to deal with the boundary of our domain we introduce Homogeneous
boundary conditions for these Sobolev spaces of differential forms.

\begin{definition}[Zero boundary condition] \label{def:zero_boundary_condition}
    We say that $\omega \in H^k(d;\Omega)$ has zero boundary condition if
    \begin{align*}
        \langle d\omega,\chi \rangle _{L^{k+1}_2(\Omega)}
        =  \langle \omega,\delta\chi \rangle _{L^k_2(\Omega)}
        \quad \forall \chi \in H^{k+1}(\delta;\Omega). 
    \end{align*}
    Denote $\mathring{H}^k(d;\Omega) \vcentcolon= \{ \omega \in H^k(d;\Omega)|\,
    \omega \text{ has zero boundary condition} \}$. 
\end{definition}
Of course we should justify why this is a reasonable definition. If $\Omega$ 
is lipschitz and bounded we have the integration by parts formula 
(cf. \cite[Thm.~6.3]{arnold})
\begin{align*}
    \int_\Omega d\omega \wedge \mu 
    = (-1)^k \int_\Omega \omega \wedge d \mu  + \int_{\partial\Omega} 
    \text{tr}\,\mu \wedge \text{tr}\,\omega \quad \text{for } \omega \in 
    H^1\Lambda^k(\Omega),\ \mu \in H^{n-k-1}(d;\Omega)  
\end{align*} 
where $H^1\Lambda^k(\Omega)$ are the differential forms with all coefficients
being in $H^1(\Omega)$ (here we mean just the standard Sobolev space). 
Let now $\omega \in \mathring{H}^k(d)$. Then if we use
the integration by parts formula and 
$\langle d\omega,\mu \rangle_{L^{k+1}(\Omega)} = 
\langle \omega, \delta \mu \rangle_{L^k(\Omega)}$ we get 
after some computation using the Hodge star
\begin{align*}
    \langle \text{tr}\,\omega, \text{tr}\,*\mu \rangle_{L^{k+1}(\Omega)}
    = 0 \quad \forall \mu \in H^1\Lambda^k(\Omega)
\end{align*}
and thus $\text{tr}\,\omega = 0$ because $H^1\Lambda^k(\Omega)$ is 
dense in $L^k_2(\Omega)$. 


Then we define the spaces 
\begin{align*}
    H^k_0(d;\Omega) &\vcentcolon= \{ \omega \in H^k(d;\Omega) 
    | d\omega = 0 \} \\
    \mathring{H}^k_0(d;\Omega) &\vcentcolon= \{ \omega \in \mathring{H}^k(d;\Omega) 
    | d\omega = 0 \}
\end{align*}
i.e. the spaces of closed forms. We will use the analogous definition for 
$H^k_0(\delta;\Omega)$ and $\mathring{H}^k_0(\delta;\Omega)$ which we call 
coclosed forms. We then define the spaces of harmonic forms
\begin{align*}
    \mathring{H}^k_0(d,\delta;\Omega) \vcentcolon= 
    \{ \omega \in \mathring{H}^k(d;\Omega) 
    | \, d\omega = 0, \delta\omega = 0 \}.
\end{align*}
With this one can prove the Hodge decomposition (\cite[Lemma 1]{arnold})
\begin{align}
    L_2^k(\Omega) = \overline{d\mathring{H}^{k-1}(d)} \stackrel{\perp}{\oplus} 
    \mathring{H}^k_0(d,\delta) \stackrel{\perp}{\oplus} 
    \overline{\delta H^{k+1}(\delta)} \label{hodge_decomposition}
\end{align}
and furthermore for the closed and coclosed forms respectively,
\begin{align}
    \mathring{H}^k_0(d) &= \overline{d\mathring{H}^{k-1}(d)} 
    \stackrel{\perp}{\oplus}
    \mathring{H}^k_0(d,\delta) \label{decomposition_closed_forms} \\
    H^k_0(\delta) &= \overline{\delta H^{k+1}(\delta)} \stackrel{\perp}{\oplus}
    \mathring{H}^k_0(d,\delta). \label{decomposition_coclosed_forms}
\end{align}

\section{Simplicial topology}

Before we can reformulate the boundary value problem in the language of 
differential forms we have to 
introduce some things from simplicial topology. This material is taken from
\cite{topology_and_geometry} where a lot more details and results can be found.

\subsection{Simplicial complex}

\begin{definition}[Affine simplex]
    Let $x_0$, $x_1$, ..., $x_k \in \real^n$ be affine independent. Then 
    \begin{align*}
    [x_0,x_1,...,x_k] \vcentcolon= \text{conv}\{x_0,...,x_k\}
    \end{align*}
    is called an affine $k$-simplex.
\end{definition}
\noindent We will assume all simplices to be affine.
%%% TBD: Question: In the book this is defined in infinite dimensions. Does this
%%% lead to any problems?

\begin{definition}[Simplicial complex]
    A \textit{simplicial complex} $K$ is a collection of affine simplices s.t.
    \begin{enumerate}
        \item $\sigma \in K \Rightarrow$ any face of $\sigma$ is in $K$,
        \item $\sigma,\, \tau \in K \Rightarrow \sigma \cap \tau$  
                is either empty or a face of both $\sigma$ and $\tau$.
    \end{enumerate}
    We call $|K| \vcentcolon= \bigcup \{ \sigma | \sigma \in K\}$ the polyhedron of 
    $K$.
\end{definition}
For any topological space $X$ a homeomorphism 
$\tau: |K| \rightarrow X$ is called \textit{triangulation} of $X$.
Let $\{x_1,\, x_2,...\}$ be the vertices in the simplicial complex $K$.
We fix an ordering of the vertices for every simplex. 
That means for any $k$ every $k$ simplex $\sigma$ has
a designated representation in the form of
\begin{align*}
    \sigma = [x_{i_0},\, x_{i_1}, ...,x_{i_k}].
\end{align*} 

\begin{definition}[$k$-chain]
    Let $K$ be a simplicial complex. By $C_k(K)$ we will denote the 
    free abelian group on the $k$-simplices
    i.e. the abelian group of all formal finite sums
    \begin{align*}
        \sum_\sigma n_\sigma \sigma
    \end{align*}
    with $\sigma$ being $k$-simplices. The elements of $C_k(K)$
    (i.e. sums of the above form) are called \textit{$k$-chains}.
\end{definition}
These groups of $k$-chains become now a chain complex by introducing the 
boundary operator $\partial$.

\begin{definition}[Boundary]
    For any simplex $[x_{i_0},\, x_{i_1},...,\, x_{i_k}]$ we define the boundary
    \begin{align*}
        \partial[x_{i_0},\, x_{i_1},...,\, x_{i_k}] \vcentcolon=
        \sum\limits_{j=0}^k (-1)^j [x_{i_0},\, x_{i_1},...,\, 
        \hat{x}_{i_j},...,\, x_{i_k}]
    \end{align*}
    where $[x_{i_0},\, x_{i_1},...,\, \hat{x}_{i_j},...,\, x_{i_k}]$ is the
    simplex without vertex $x_{i_j}$. We then extend the definition
    of the boundary operator linearly to $k$-chains 
    $c = \sum_\sigma c_\sigma \sigma$ by
    \begin{align*}
        \partial c \vcentcolon= \sum\limits_\sigma c_\sigma \partial \sigma.
    \end{align*}.
\end{definition}

A crucial property of the chain operator is the following.

\begin{proposition}
    $\partial \circ \partial = 0$.
\end{proposition}
\begin{proof}
    This can be proven by direct computation, analogous to 
    \cite[Chap.~4, Lemma~1.6]{topology_and_geometry}
\end{proof}

\subsection{(Co-)Homology}

We call a $k$-chain $c$ a \textit{$k$-cycle} if $\partial c = 0$ and we call $c$ 
a \textit{$k$-boundary} if there exists a $(k+1)$-chain $d$ s.t. 
$c = \partial d$. Let $Z_k(K) \subseteq C_k(K)$ be the subgroup of $k$-cycles
and $B_k(K) \subseteq C_k(K)$ the subgroup of $k$-boundaries.
We can now define the simplicial homology groups of our simplicial complex.

\begin{definition}[Simplicial homology]
    The homology groups $H_k(K)$ are the quotient groups of 
    cycles and boundaries i.e.
    \begin{align*}
        H_k(K)\vcentcolon= \faktor{Z_k(K)}{B_k(K)}.
    \end{align*}
\end{definition}
\noindent The homology groups are independent of the chosen simplicial complex.
\cite[p.248]{topology_and_geometry}. 


Let $G$ be any group. Then we define the group 
of \textit{$k$-cochains} $C^k(K;G)$ by
\begin{align*}
    C^k(K;G) \vcentcolon= \text{Hom}(C_k(K),\,G)
\end{align*}
i.e. the group of all homomorphisms from $k$-chains to $G$. 
We generally use the superindex if something is related to 
cochains and the subindex if it is related to chains. 
We now introduce an operator between these spaces of cochains.
\begin{definition}
    We define the operator $\delta: C^k(K;G) \rightarrow C^{k+1}(K;G)$ via
    \begin{align*}
        (\delta f) (c) \vcentcolon= f(\partial c).
    \end{align*}
    for a $(k+1)$-chain $c$.
    We call a cochain $f \in C^k(K;G)$ \textit{closed} if $\delta f = 0$ 
    and we call $f$
    \textit{exact} if there is a $g \in C^{k+1}(K;G)$ s.t. $f = \delta g$.
\end{definition}
\noindent We define the cohomology spaces analogous to homology spaces above.
\begin{definition}[Simplicial cohomology]
    Denote the closed $k$-cochains as $Z^k(K;G)$ and the 
    exact ones with $B^k(K;G)$. 
    We then define the \textit{simplicial cohomology groups}
    $H^k(K)$ as
    \begin{align*}
        H^k(K;G) \vcentcolon= \faktor{Z^k(K;G)}{B^k(K;G)}.
    \end{align*}
\end{definition}
Note that in the case of $G = \real$ this becomes a vector space.
We will later show that if we consider certain subspaces of cochains so called
\textit{p-summable} cochains that the $L^p$-cohomology defined above and the
cohomology spaces of these $p$-summable cochains are isomorphic.


Now of course there is the question how the homology and cohomology groups 
are related to each other. This question is answered by the
\textit{universal coefficent theorem}. But before we can formulate it we have 
to introduce exact sequences.
\begin{definition}[Exact sequence]
    Let $(G_i)_{i\in \integers}$ be a sequence of groups and 
    $(f_i)_{i \in \integers}$ be a sequence of homomorphisms
    $f_i: G_i \rightarrow G_{i+1}$. Then this sequence of homomorphisms is
    called \textit{exact} if $\text{im}\,f_{i-1} = \text{ker}\,f_i$.
\end{definition}

The universal coefficent theorem in the case of simplicial homology states
that the sequence 
\begin{align}
    0 \rightarrow \text{Ext}(H_{k-1}(K),G) \rightarrow 
    H^k(K;G) \xrightarrow{\beta} \rightarrow \text{Hom}(H_k(K),G) 
    \rightarrow 0 \label{univeral_coefficient_theorem}
\end{align}
is exact. 
$\beta$ is defined via $\beta([F])([c]) \vcentcolon= F(c)$.
The definition of Ext can be found in \cite{topology_and_geometry},
but it does not matter for our purpose because from now on we will assume
$G = \real$ and
$\text{Ext}(H_{k-1}(K),\real) = 0$. This follows from the fact that 
$\real$ is a divisible and hence injective abelian group. The definition 
these terms and the connections used can also be found in 
\cite[Sec.~V.6]{topology_and_geometry}. However, we will not dwelve into the 
algebraic background further. We can conclude from the exactness of the 
above short sequence that $\text{ker}\,\beta = 0$ and 
$\text{im}\,\beta = \text{Hom}(H_k(K),\real)$. So $\beta$ is a isomorphism.


As an application, we will show the following proposition which will be used
later to show uniqueness of a solution of the magnetostatic problem.

\begin{proposition}\label{prop:uniqueness_cochain}
    Assume that $H_1(K) = \integers [\gamma]$ i.e. the homology class of the 
    closed $1$-chain $\gamma$ is a generator of the first homology group.
    Then we have the following:
    \begin{enumerate}[(i)]
        \item For any $C_0 \in \real$ there exists a closed $1$-chain 
            $F \in Z^1(K)$ with $F(\gamma) = C_0$,
        \item any other $G \in Z^1(K)$ with $G(\gamma) = C_0$ 
            is in the same cohomology class i.e. $[F] = [G]$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \textbf{Proof of (i)} %TBD: This could be wrong
    Because $[\gamma]$ is a generator of the homology group we  obtain a 
    homomorphism $\hat{F} \in \text{Hom}(H_1(K),\real)$ by fixing
    $\hat{F}([\gamma]) = C_0$. This determines the other values.
    Then we know from (\ref{univeral_coefficient_theorem}) that there exists
    a $[F] \in H^1(K)$ with $\beta([F]) = \hat{F}$ because $\beta$ is a 
    isomorphism. So we obtain
    \begin{align*}
        F(\gamma) = \beta([F])([\gamma]) = \hat{F}([\gamma]) = C_0.
    \end{align*}

    \textbf{Proof of (ii)} %TBD: This could be wrong
    Take $[c] \in H_1(K)$ arbitrary. Then there exists  $n \in \integers$ s.t.
    $[c] = n [\gamma]$.
    Using $\beta$ from (\ref{univeral_coefficient_theorem})
    We have
    \begin{align*}
        \beta([F])([c]) = \beta([F])(n [\gamma]) 
        = n \beta([F])([\gamma]) = n \, F(\gamma) = n \, G(\gamma) = 
        \beta([G])([c])
    \end{align*}
    and thus $\beta([F]) = \beta([G])$. Because $\beta$ is an isomorphism
    we arrive at $[F] = [G]$.
\end{proof}


\section{Isomorphism of Cohomology}

In order to show existence and uniqueness of solutions of the magnetostatic 
problem we rely on a result about the isomorphism of a simplicial 
cohomology space $H^k_p(K)$ and the $L^p$-cohomology space 
$H^k_{p,dR}(\omegabar)$.
This result was proven in \cite{goldshtein}. In the diploma thesis of Nikolai
Nowaczyk \cite{nowaczyk}, which mostly is based on this paper, 
many additional details can be found. The result will be presented in the
next section. It should be noted that even though the results in 
\cite{goldshtein} are
proved explicitely for smooth manifolds without boundary the results can be 
extended to Lipschitz manifolds with boundary (see the proof of Theorem 2 and 
the remark at the end in \cite{goldshtein}). Therefore, we can apply the result
to our case.

In this section, we will summarize the essential parts of \cite{goldshtein}
which will be needed later on. 

Before we state the theorem about the isomorphism of we will first formulate 
a crucial assumption for this result to hold.


Because $\omegabar$ from our problem is itself a polyhedron we can
assume that $\omegabar$ and $|K|$ are equal as subsets of $\real^n$ and we can
simply use the identity as triangulation.
However, we will use different metrics on $|K|$ and $\omegabar$. 
We use the Euclidian metric on 
$\omegabar$ and we use the standard simplicial metric on $|K|$ (cf. 
\cite[p.191]{goldshtein}). This metric is defined as follows:

Choose some numbering of the vertices $\{ x_1,\, x_2, ... \}$ and
take $f: |K| \rightarrow \ell^2$ where $\ell^2$ is the 
Hilbert space of real-valued square-summable sequences s.t. $f(x_i) = e_i$ 
with $e_i \in \ell^2$ being the standard unit vectors and $f$ is affine on 
every simplex. This mapping is unique.%%%TBD: Proof uniqueness%%%%

Then we define the metric on $|K|$ as the pullback $g_S = f^*g$ 
where $g$ is the standard metric in $\ell^2$. Let $\langle \cdot , 
\cdot \rangle$ be the standard scalar product on $\ell^2$. Then for $x \in |K|$ 
and $\sum_{i=1}^n v_i \frac{\partial}{\partial x_i}, \; 
\sum_{j=1}^n w_j \frac{\partial}{\partial x_j} \in T_x |K|$ we have 
\begin{align*}
g_S|_x\left(\sum_{i=1}^n v_i \frac{\partial}{\partial x_i}, 
\sum_{j=1}^n w_j \frac{\partial}{\partial x_j}\right) &= 
\left\langle \sum_{k=1}^\infty \sum_{i=1}^n v_i 
\frac{\partial f_k}{\partial x_i} (x)
\frac{\partial }{\partial y_k}, 
\sum_{l=1}^\infty \sum_{j=1}^n w_j \frac{\partial f_l}{\partial x_j} (x)
\frac{\partial }{\partial y_l} \right\rangle \\   
&= \sum_{i,j=1}^n \sum_{k,l=1}^\infty v_i \frac{\partial f_k}{\partial x_i} (x)
w_j \frac{\partial f_l}{\partial x_j} (x) 
\left\langle \frac{\partial }{\partial y_k}, \frac{\partial }{\partial y_l} 
\right\rangle\\
&= \sum_{i,j=1}^n \sum_{k=1}^\infty v_i \frac{\partial f_k}{\partial x_i} (x)
w_j \frac{\partial f_k}{\partial x_j} (x)\\
&= \sum_{i,j=1}^n \sum_{k=1}^\infty v_i w_j \left( Df(x)^T Df(x) \right)_{ij} \\
&= v^T Df(x)^T Df(x) w = \left\langle Df(x) v, Df(x) w \right\rangle,
\end{align*}
where $D$ denotes the Jacobian. 
{\color{red} (TBD: This Jacobian as written here would technically be in 
$\real^{\infty \times n}$. Only finitely many lines are non-zero though, 
but this is not quite rigorous yet. )}
%%% TBD: This is only well-defined if x is in the interior of a full simplex.

We have two crucial assumptions on the triangulation for the result to hold 
(cf. \cite[p.194]{goldshtein}). We summarize them under 
\textit{GKS-condition} named after the three authors of \cite{goldshtein}.

\begin{assumption}[GKS-condition]
    We will assume the following on the simplicial complex $K$ 
    and the triangulation $\tau$:
    \begin{enumerate}
    \item The star of every vertex in $K$ contains at most $N$ simplices.
    \item For the differential of $\tau$ we have constants 
        $C_1, C_2 > 0$ s.t.
        \begin{align*}
        \lVert d\tau|_x \rVert < C_1, \; 
        \lVert d\tau^{-1}|_{\tau(x)} \rVert < C_2,
        \end{align*}
        where $d$ denotes the differential in the sense of differential 
        geometry and the norm is the operator norm w.r.t. the metrics on $|K|$ 
        and $\omegabar$.
    \end{enumerate}
\end{assumption}
The first assumption is equivalent to every vertex being contained in
at most $N$ simplices, which is fulfilled if we have a shape regular mesh.\par
%%% TBD: Reference or proof or sth%%%

Because $\tau$ is just the identity in our case 
the second assumption says that for every 
$x \in |K|$
\begin{align*}
\sup\limits_{v \neq 0} \frac{\lVert v \rVert}{\sqrt{g_S|_x(v,v)}} =
\sup\limits_{v \neq 0} \frac{\lVert v \rVert}{\lVert Df(x)v\rVert} < C_1
\end{align*}
and analogously
\begin{align*}
    \sup\limits_{v \neq 0} \frac{\lVert Df(x)v\rVert}{\lVert v \rVert} < C_1.
\end{align*}
%%% TBD: Give more details and interpretation

\subsection{S-forms}
\begin{definition}[Induced map]
    Let $V$ and $W$ be real vector spaces, $X \subseteq V$, $Y \subseteq W$ be 
    subspaces. For a linear map $L: V \rightarrow W$ with $L(X) \subseteq Y$ 
    we define the induced map
    \begin{align*}
        [L]: \faktor{V}{X} \rightarrow \faktor{W}{Y},\,
        [v] \mapsto [Lv].
    \end{align*}     
\end{definition}
It is easy to check that the induced map is well-defined using the
definition of quotient space. %% Proven on the 27.11.2022


The first isomorphism is induced from a linear mapping
from the so called \textit{S-forms} 
$S_p^k(K)$ to 
\textit{p-summable $k$-cochains} $C_p^k(K)$ which will both 
be defined next.

\begin{definition}
    We define the following norm of a $k$-cochain $f$
    \begin{align*}
    \norm{f}{C_p^k(K)} \vcentcolon= 
    \left( \sum\limits_{c \, k\text{-chain}} |f(c)|^p \right)^{1/p}.
    \end{align*} % TBD: Define K^(k), this is a convenient notation
    and the space of \textit{p-summable k-cochains}
    \begin{align*}
    C_p^k(K) \vcentcolon= \{f \in C^k(K) | \,  
    \norm{f}{C_p^k(K)} < \infty \}.
    \end{align*}
\end{definition}
Take $\tau, \sigma \in K$ s.t. $\tau$ is a face of $\sigma$ which we write as
$\tau < \sigma$. We need a restriction operator 
$j^*_{\tau,\sigma}:W_{\infty,loc}^k(\sigma) \rightarrow W_{\infty,loc}^k(\tau)$.
This is done by extending $\omega \in W_{\infty,loc}^k(\sigma)$ first 
to some $\tilde{\omega}\in W_{\infty,loc}^k(U)$ with 
$U$ an open neighborhood of $\sigma$ in the affine hull of $\sigma$. Then 
$\tau \subseteq U$ and we apply a restriction operator $j^*_{\tau,U}$
and define $j^*_{\tau,\sigma} \omega \vcentcolon= j^*_{\tau,U}\tilde{\omega}$. 
This restriction operator is then well defined, 
bounded and independent of the chosen 
extension $\tilde{\omega}$ (cf. \cite[p.191]{goldshtein}). It should be 
emphasized that this restriction only works for $W^k_\infty$ and fails for 
$W^k_p$, $p<\infty$. 

\begin{definition}[S-forms]
    Let 
    \begin{align*}
    \theta = \{ \theta(\sigma) \in W^k_\infty(\sigma) | \sigma \in K\}
    \end{align*}
    be a collection of differential $k$-forms. We call $\theta$ \textit{S-form 
    of degree
    $k$} if we have for all simplices
    $\mu <\sigma$ 
    \begin{align*}
    j^*_{\sigma,\mu}\theta(\sigma) = \theta(\mu).
    \end{align*}
    We denote with $S^k(K)$ the space of all S-forms of degree $k$ 
    over the chain complex $K$. 
    For $\theta \in S^k(K)$ we define $d\theta \vcentcolon= \{ d\theta(\sigma) | 
    \,\sigma \in K \} \in S^{k+1}(K)$. $S^*(K)$ is the resulting cochain complex.
    % TBD: Did i define what a cochain complex is?
\end{definition}
For $\theta \in S^k(K)$ we now define the norm
\begin{align*}
\lVert \theta \rVert _{S_p(K)}  \vcentcolon= \left( \sum_{\sigma \in K} 
\lVert \theta(\sigma) \rVert _{W^k_\infty(\sigma)}^p \right)^{1/p}.
\end{align*} 
$S^k_p(K)$ are the S-forms of degree $k$ s.t. this norm is finite.

The integration of an S-form $\theta \in S^k(K)$ over a chain
$c = \sum n_\sigma \sigma \in C_k(K)$ is then simply defined as 
\begin{align*}
    \int_c \theta 
    \vcentcolon= \sum\limits_\sigma n_\sigma \int_\sigma \theta(\sigma).
\end{align*}
We also write $I(\theta)(c) \vcentcolon= \int_c \theta$.
Then the integration mapping $I: S^k(K) \rightarrow C^k(K)$ is a homomorphism
(see \cite[p.191]{goldshtein}).
The reason why S-forms are a useful concept is because they provide an 
intermediate step between differential forms and cochains.

With the exterior derivative $d$ on S-forms as defined above we define 
\begin{align*}
    \mathscr{Z}^k &\vcentcolon= \{ \theta \in S^k(K) | \, d\theta = 0 \} \\
    \mathscr{B}^k &\vcentcolon= dS^{k-1}(K)
\end{align*}
and then the resulting cohomology space
\begin{align*}
    \mathscr{H}^k(K) \vcentcolon= 
    \faktor{\mathscr{Z}^k}{\mathscr{B}^k}.
\end{align*}
We also define the in the case of $p$-summable S-forms
\begin{align*}
    \mathscr{Z}_p^k &\vcentcolon= \{ \theta \in S_p^k(K) | \, d\theta = 0 \} \\
\end{align*}
as well $\mathscr{B}_p^k$ and $\mathscr{H}_p^k(K)$ analogously.

Then we have that the integration mapping
$I: S^k(K) \rightarrow C^k(K)$ 
induces an isomorphism on the cohomologies i.e. 
$[I]: \mathscr{H}^k(K) \rightarrow H^k(K)$ is an isomorphism of vector 
spaces (see \cite[p.191]{goldshtein}).
Also $I: S_p^k(K) \rightarrow C_p^k(K)$ is well defined and induces an
isomorphism on the respective cohomology spaces as well. Furthermore, 
$I$ is continuous.
(see \cite[Thm.\,1]{goldshtein} and the proof thereof).



\subsection{Isomorphism between cohomologies of S-forms and $L^p$-cohomology}


The next step is to obtain an isomorphism between the cohomology 
of S-forms $\mathscr{H}_p^k(K)$ and the $L_p$ cohomology 
$\lpcoho(\omegabar)$. 
In order to achieve that we need a some connection between differential forms
and S-forms. Take $\omega \in W_{\infty,loc}^k(\omegabar)$. Using the analogous
reasoning as above, we use the restriction operators $j^*_{\sigma,\tau}$ to 
restrict $\omega$ to the simplices. Denote the resulting 
forms as $\omega(\sigma) \in W^k_{\infty,loc}(\sigma)$. So we obtain an 
S-form $\{ \omega(\sigma) | \, \sigma \in K \}$. This way we constructed 
an operator 
\begin{align}
    \varphi: W_{\infty,loc}^k(\omegabar) \rightarrow S^k(K),\ \omega \mapsto 
    \{ \omega(\sigma) | \, \sigma \in K \} \label{eq:forms_Sforms_isom}
\end{align}
This 
operator $\varphi$ is an isomorphism \cite[Lemma~1]{goldshtein}. 
To also obtain corresponding forms to the $p$-summable S-forms we simply 
define $S^k_p(\omegabar) \vcentcolon= \varphi^{-1}S^k_p(K)$.
It can be shown that $S^k_p(\omegabar) \subseteq W^k_p(\omegabar)$.
Now if we have some $\omega \in S^k_p(\omegabar)$ then we have can look at 
two possible norms. From the inclusion we know that 
$\norm{\omega}{W^k_p(\omegabar)} < \infty$. But we can also use the norm 
induced by $\varphi$ denoted by 
\begin{align}
    \norm{\omega}{S^k_p(\omegabar)} 
    \vcentcolon= \norm{\varphi \omega}{S^k_p(K)}. \label{eq:induced_norm}
\end{align}
Let us briefly show that this is indeed a norm.
\begin{proposition}
    Let $K$ be a simplicial complex and $\omegabar = |K|$. 
    Then $\norm{\cdot}{S^k_p(\omegabar)}$ 
    is a norm and $\varphi$ as defined at (\ref{eq:forms_Sforms_isom})  
    is an isometry.
\end{proposition}
\begin{proof}
    Subadditivity and absolute homogeneity follow directly from the linearity 
    of $\varphi$ and the corresponding property of $\norm{\cdot}{S^k_p(K)}$.
    For the positive definiteness 
    \begin{align*}
        \norm{\omega}{S^k_p(\omegabar)} = 0 
        \Leftrightarrow \norm{\varphi \omega}{S^k_p(K)}
        \Leftrightarrow \varphi \omega = 0
        \stackrel{\varphi \text{ isom.}}{\Leftrightarrow} \omega = 0.
    \end{align*}
    $\varphi$ is an isometry by construction of the norm.
\end{proof}
We then also have that the inclusion operator $\iota: S^k_p(\omegabar) 
\hookrightarrow W^k_p(\omegabar)$
is bounded (\cite[Lemma\,4]{goldshtein}). 

\begin{remark} \label{rem:local_construction_regularization}
    In the paper \cite{goldshtein}, no difference is made between the spaces 
    $S^k_p(\omegabar)$ and $S^k_p(K)$ because they can be identified with each 
    other via $\varphi$. However, we will follow the approach from Nowaczyk's 
    thesis \cite{nowaczyk} to treat them separately because it is more precise 
    and less confusing.
\end{remark}


Now we also want to introduce a regularization operator in order to 
obtain 
a form in $S^k_p(\omegabar)$ from form $W^k_p(\omegabar)$. 
This is done 
using two operators $\rop: L^k_{1,loc}(\omegabar) \rightarrow 
L^k_{1,loc}(\omegabar)$ and $\aop: L^k_{1,loc}(\omegabar) \rightarrow 
L^{k-1}_{1,loc}(\omegabar)$.
We will not go over their construction but instead we will only use
some properties that we collect in the following theorem
(cf. \cite[Thm.2]{goldshtein}).

\begin{theorem}\label{thm:operators}
    Assume that the triangulation $\tau$ fulfills the GKS-condition 
    defined at Def.~\ref{def:GKS_condition}.
    Then there exist linear mappings 
    $\mathscr{R}: L^k_{1,loc}(\omegabar) \rightarrow 
    L^k_{1,loc}(\omegabar)$, $\mathscr{A}: L^k_{1,loc}(\omegabar) 
    \rightarrow L^{k-1}_{1,loc}(\omegabar)$ 
    such that
    \begin{enumerate}[(i)]
        \item $\rop(W^k_{1,loc}(\omegabar)) \subseteq W^k_{1,loc}(\omegabar)$,
            $\aop(W^k_{1,loc}(\omegabar)) \subseteq W^{k-1}_{1,loc}(\omegabar)$
            and $\mathscr{R}\omega - \omega = 
            d\mathscr{A}\omega + \mathscr{A}d\omega$ and 
            $d\rop \omega  = \rop d \omega$ for 
            $\omega \in W^k_{1,loc}(\omegabar)$
        \item for any $1 \leq p \leq \infty$, 
            $\rop(W^k_p(\omegabar)) \subseteq S^k_p(\omegabar)$ and
            $\aop(S^k_p(\omegabar)) \subseteq S^{k-1}_p(\omegabar)$
        \item $\rop: W^k_p(\omegabar) \rightarrow 
            (S^k_p(\omegabar),\norm{\cdot}{S^k_p(\omegabar)})$ is bounded (here
            we mean with $(S^k_p(\omegabar),\norm{\cdot}{S^k_p(\omegabar)})$ 
            the space $S^k_p(\omegabar)$ endowed with the norm 
            $\norm{\cdot}{S^k_p(\omegabar)}$))
    \end{enumerate}
\end{theorem}

Let 
$\iota: S^k_p(\omegabar) \hookrightarrow W^k_p(\omegabar)$ be the inclusion operator. 
The inclusion induces an
isomorphism on cohomology \cite[Lemma 4, Corollary]{goldshtein} i.e. 
$[\iota]: \mathscr{H}_p^k(K) \rightarrow \lpcoho(\omegabar)$ is an isomorphism. 


\begin{remark}
    Let $L \subseteq K$ be a full-dimensional %TBD: Define that
    simplicial subcomplex. Let $\rop_L$ be the regularization operator 
    constructed for this simplicial subcomplex. The construction of the
    regularization operator is done locally on the stars of the vertices. %TBD: Define stars
    Therefore if we now look at a vertex $x_i \in L$ s.t. its star 
    $\Sigma_i$ does not include any boundary vertices of $L$ then we have 
    $\rop \omega = \rop_L(\omega|_{|L|})$ for any $\omega \in W^k_{1,loc}(|K|)$
    if we choose the ordering of the vertices appropriately.
    We will not prove this because it would require to go over the construction
    of the operator which we want to avoid as it is quite technical. Thus, 
    we refer to \cite[Sec.\,2]{goldshtein} for further details.
\end{remark}


% However, the question remains how we can go to the other direction i.e.

% In conclusion, we get the following isomorphisms of cohomologies:
% \begin{align*}
%     \lpcoho(\omegabar) \xrightarrow{[\iota]^{-1}} \mathscr{H}_p^k(K) 
%     \xrightarrow{[I]} H^k_p(K).
% \end{align*}
% This result will be crucial in the next section to obtain a unique solution
% to our problem.

% The idea is that for a $k$-form $\theta$ we have the cochain 
% $I(\theta) \in C^k(K)$, $I(\theta)(\sigma) = \int_\sigma \theta$ for any
% $k$-simplex $\sigma$. We want to show that this map induces a isomorphism on
% cohomology. 

% In the next step, we will use two operators $\rop$ and $\aop$ from 
% \cite{goldshtein}.
% The precise definition and details of their construction
% are not relevant for our purposes because we will only use
% the some properties that we collect in the following theorem
% (cf. \cite[Thm.2]{goldshtein}). Let 
% \begin{align*}
%     S^k_p(\omegabar) = \{ \eta \in W^k_{\infty,loc} | \, 
%     I\eta \in C^k_p(K)\}.
% \end{align*}

% Now define $\bar{I} \vcentcolon= I \circ \rop$. This gives a well-defined 
% mapping from $W^k_p(\omegabar)$ to $C^k_p(K)$. Following the arguments of 
% \cite{goldshtein} and using the properties of $\rop$ and $\aop$ one can show 
% that the induced homomorphism of cohomologies 
% $[\bar{I}]: H^k_{p,dR}(\omegabar) \rightarrow H^k_p(K)$ is an isomorphism.
% This isomorphism will play a crucial part in the proof of uniqueness and 
% existence of solutions in the next section.


\section{Existence and uniqueness of solutions}

\subsection{Reformulation of the problem} 

We will return now to the magnetostatic problem. In order to use the results
above we will reformulate the problem in the notation of differential forms.
From now on we assume $n=3$ i.e. we are in three dimensional space.
There are two ways to identify a vector field with a differential form 
(cf. \cite[Table 6.1 and p.70]{arnold}) either as a 1-form or a 2-form. 
For a vector field $B$ we define
\begin{align*}
    F^1\, B &\vcentcolon= B_1 \, dx_1 + B_2 \, dx_2 + B_3\, dx_3 \text{ and}\\
    F^2\, B &\vcentcolon= B_2 \, dx_2 \wedge dx_3 - B_2 \, dx_1 \wedge dx_3
        + B_3 \, dx_1 \wedge dx_2
\end{align*} 
as the corresponding 1-form and 2-form. 
Then the exterior derivative is $dF^2\,\omega$ corresponds to the divergence,
the codifferential $\delta F^2\,\omega$ 
corresponds to the curl and the normal component
being zero on the boundary corresponds 
to $\omega \in \mathring{H}^2(d)$.\cite{}. 

If we then use the association of
3-forms with scalars we have the corresponding boundary value problem without
the integral condition for 
2-forms: Find $\omega \in \mathring{H}^2(d)$ s.t.
\begin{align}
    \delta \omega &= 0, \\ 
    d\omega  &= 0 \text{ in } \Omega.
\end{align}
Next, we have to add the integral condition. 
We remind the reader that we are in three dimensions so
$**= \text{Id}$ 
and observe
\begin{align*}
    *F^2 \, B  &= B_1 \, **dx_1 + B_2 \, **dx_2 + B_3\, **dx_3 
        = B_1 \, dx_1 + B_2 \, dx_2 + B_3\, dx_3\\ 
    &= F^1 \, B.
\end{align*}
{\color{red}: Actually, we already use the Hodge star to define the vector 
proxies. So of course the vector proxy of the Hodge star will be the same.}
Then we have 
\begin{align*}
    \int_\gamma * F^2\, B = \int_\gamma F   ^1\, B = \int_\gamma B \cdot \text{d}l.
\end{align*}
In the last step we used the fact that the integration of a 1-form over a
curve is equivalent to the curve integral of the associated vector field
(cf. \cite[Sec. 6.2.3]{arnold}). Hence, we can add the integral condition 
\begin{align}
    \int_\gamma *\omega = C_0 \label{integral_condition}.
\end{align}
However, we have  only $\omega \in \mathring{H}_0^2(d,\delta)$ so 
$*\omega \in H^1(d)$ so this integral might not be well defined. In order 
to deal with this, we will again use the operator $\rop$ from 
Sec.\,\ref{sec:isomorphism_cohomology}. 

We know from Thm.~\ref{thm:operators} that $\rop *\omega \in S^1_2(\omegabar)$.
Using the operator $\varphi$ from \ref{eq:} we obtain 
$\varphi \rop *\omega \in S^1_2(K)$. Now we know from Sec.~\ref{sec:} that 
the integration mapping $I: S^1_2(K) \rightarrow C^1_2(K)$ is well-defined.
Denote $\bar{I} \vcentcolon= I\circ \varphi \circ \rop$ and 
let us replace the integral condition (\ref{eq:integral_condition}) with 
\begin{align*}
    \bar{I}(*\omega)(\gamma) = C_0.
\end{align*}

Of course, we have to justify why this is reasonable. 
So let us take $\eta \in S^1_2(\omegabar)$. That means we can integrate it 
directly using the definition from \ref{}. 
Let us also assume that $\eta$ is closed and 
$\int_\gamma \eta = C_0$. %TBD: Define the integral on S^k_p(\omegabar)
Then we know from Thm.~\ref{thm:operators}
\begin{align*}
    \rop \eta = \eta + d\aop \eta + \aop d\eta 
    \stackrel{\eta \text{ closed}}{=} \eta + d\aop \eta.
\end{align*}
We know further that $\aop \eta \in S^0_2(\omegabar)$. 
Apply $\varphi$ on both sides and use that fact that it commutes with the 
exterior derivative to get
\begin{align*}
    \varphi \rop \eta = \varphi\eta + d \varphi\aop \eta.
\end{align*}
$[I]$ is an isomorphism of cohomology and thus sends exact S-forms to exact 
cochains. $\gamma$ is closed so $I(d \varphi\aop \eta)(\gamma) = 0$ and 
we conclude 
\begin{align*}
    \bar{I}(\eta)(\gamma) = I(\varphi \rop \eta)(\gamma) = I(\varphi \eta)
    \stackrel{\text{by def.}}{=} I(\eta),
\end{align*}
i.e. the integral remains unchanged if we integrate closed forms over 
closed chains. Because $*\omega$ is closed we thus do not change the integral 
if the curve integral $*\omega$ would already have been well defined before.

To summarize we obtain the following problem.
\begin{problem}
    Find $\omega \in \mathring{H}^2(d;\Omega)$ s.t.
    \begin{align*}
        d \omega &= 0, \\
        \delta \omega &= 0 \text{ in $\Omega$}, \\
        \bar{I}(*\omega)(\gamma)  &= C_0.
    \end{align*}
\end{problem}
\noindent We will examine existence and 
uniqueness of this problem in the next section.


\subsection{Existence and uniqueness}

% We start with the following
% \begin{proposition}\label{uniqueness_cochain}
%     Let $\gamma$ be a closed $k$-chain s.t. the homology class $[\gamma]$ 
%     spans the homology space $H^k_c$. Then for any $C_0 \in \real 
%     \setminus \{0\}$ 
%     if we have closed cochains $F,G$ s.t.
%     \begin{align*}
%     F(\gamma) = G(\gamma)= C_0
%     \end{align*}
%     then $[F] = [G]$ i.e. their cohomology classes are equal.
% \end{proposition} 
% \begin{proof}
%     From \cite[Sec. 2.5]{arnold} we know that 
%     $\text{dim}\,H^k(K) = \text{dim}\,H^k_c$. Because $F$ and $G$ are closed we
%     therefore have $\lambda_F, \lambda_G \in \real$ and a cohomology class 
%     $[b]$ s.t.
%     $[F] = \lambda_F [b]$ and $[G] = \lambda_G [b]$. This is 
%     equivalent to the existence of $(k-1)$-cochains $J_F,J_G$ s.t. 
%     \begin{align*}
%         F = \lambda_F b + \delta J_F \text{ and } G = \lambda_G b + \delta J_G.
%     \end{align*}
%     so 
%     \begin{align*}
%         0 \neq \lambda_F b(\gamma) + \delta J_F(\gamma) = F(\gamma) = G(\gamma)
%         = \lambda_G b(\gamma) + \delta J_F(\gamma).
%     \end{align*}
%     Because $\gamma$ is closed we have for any $(k-1)$-chain $J$, 
%     $\delta J(\gamma) = J(\partial \gamma) = 0$ and so we arrive at
%     $\lambda_F = \lambda_G$ i.e. $[F] = [G]$.
% \end{proof}


We start with the following

\begin{proposition}\label{integral_exact_form_zero}
    Let $(\phi_i)_{i\in\mathbb{N}} \subseteq H^0(d)$ s.t. 
    $(d\phi_i)_{i\in\mathbb{N}}$ 
    is convergent and let $\gamma \in C_1(K)$ be a bounded closed $1$-chain.
    Then
    \begin{align*}
        \bar{I}(\lim\limits_{i \rightarrow \infty}d\phi_i)(\gamma) = 0.
    \end{align*}
\end{proposition}
\begin{proof}
    % Let $L \subseteq K$ be a bounded simplicial subcomplex 
    % s.t. it is full dimensional and $\gamma \in C_1(L)$
    % {\color{red} Make this more rigorous. We need to be able to restrict 
    % $L^2$-functions without problems.}  That means there is
    % $\phi_L \in H^0(d;|L|)$ s.t.
    % $\lim\limits_{i\rightarrow \infty} d\phi_i = d\phi_L$. 
    % We can now use the existence and properties of the operators from 
    % Thm\,\ref{operators}, but on $L$ instead of $K$. We call the operators 
    % $\rop_L$ and $\aop_L$. Then we have 
    
    Because 
    $[\bar{I}]$ is an isomorphism of cohomology $\bar{I}$ has to send 
    exact forms to exact cochains. Because $\gamma$ is a closed $1$-chain 
    we obtain $\bar{I}(d\psi)(\gamma) = 0$ for every $\psi \in H^0(d)$. Because
    $\rop$, $\phi$ and $I$ are all bounded
    $\bar{I}$ is a continuous operator \ref{} and so we have 
    $\bar{I}(\lim\limits_{i \rightarrow \infty}d\phi_i) = 
    \lim\limits_{i \rightarrow \infty} \bar{I}(d\phi_i)$ with the limit of 
    cochains taken w.r.t. the norm 
    in $C^1_2(K)$. Now let $J_\gamma$ be the set of indices of simplices 
    contained in $\gamma$ i.e.
    \begin{align*}
        \gamma = \sum\limits_{i \in J_\gamma} \sigma_i.
    \end{align*}
    Here we remind that we fixed the ordering and indices for our simplicial 
    complex \ref{}. Let $N_\gamma \vcentcolon= |J_\gamma|$ which is finite. Then 

    \begin{align*}
        &\left| \left( \lim\limits_{i \rightarrow \infty} \bar{I}(d\phi_j) 
        \right) (\gamma) \right| 
        \leq \left| \left( \lim\limits_{i \rightarrow \infty} \bar{I}(d\phi_i) 
        - \bar{I}(d\phi_j) 
        \right) (\gamma) \right| \\
        &\leq \sum\limits_{k \in J_\gamma} 
        \left| \left( 
            \lim\limits_{i \rightarrow \infty} \bar{I}(d\phi_i) 
            - \bar{I}(d\phi_i) 
        \right) (\sigma_k) \right| \\
        &\leq N^{1/2}_\gamma \left(
            \sum\limits_{k \in J_\gamma} 
            \left| \left( 
                    \lim\limits_{i \rightarrow \infty} \bar{I}(d\phi_i) 
                    - \bar{I}(d\phi_j) 
                \right) (\sigma_k) 
            \right|^2
        \right)^{1/2} \\
        &\leq N^{1/2}_\gamma \lVert  
            \lim\limits_{i \rightarrow \infty} \bar{I}(d\phi_i)
            - \bar{I}(d\phi_j)
        \rVert _{C^{1}_2(K)} 
        \leq N^{1/2}_\gamma \epsilon
    \end{align*}
    and thus 
    \begin{align*}
        \left| \left( \lim\limits_{i \rightarrow \infty} \bar{I}(d\phi_i) 
        \right) (\gamma) \right| = 0
    \end{align*}
    because $\epsilon$ was arbitrarily small. {\color{red} This can be done 
    more elegantly by identifying $C^1_2(K)$ with $\ell^2$. 
    See notes from 28.12}
    % For every closed $1$-form $\nu \in H^1(d)$ we have 
    % \begin{align*}
    %     \bar{I}(\rop \nu)(\gamma) = \int_\gamma \rop \rop \nu 
    %     = \int_\gamma \rop \nu + d\aop\rop\nu + \aop d\rop \nu 
    %     = \bar{I}(\nu)(\gamma)
    % \end{align*}
    % where we used the properties of $\rop$ from Thm\,\ref{operators}. 
    % Let $\tilde{\Omega}$ be a bounded
    % subdomain of $\Omega$.
    % Because the image of $d$ is closed for every bounded domain 
    % (cf. \cite[Lemma 7]{picard}) we have that for any convergent sequence 
    % $(d\psi_i)_{i\in \mathbb{N}} \subseteq L^1_2(\Omega)$ 
    % there exists a $\psi \in H^0(d;\tilde{\Omega})$ s.t.
    % \begin{align*}
    %     \lim\limits_{i \rightarrow \infty}d\psi_i| _{\tilde{\Omega}} 
    %     = d\tilde{\psi}.
    % \end{align*}
    % Then we use the continuity of $\rop$
    % \begin{align*}
    %     \bar{I}(\lim\limits_{i \rightarrow \infty}d\phi_i) =
    %     \bar{I}(\rop \lim\limits_{i \rightarrow \infty}d\phi_i) = 
    %     \bar{I}(\lim\limits_{i \rightarrow \infty}d\rop \phi_i) =
    %     \int_\gamma \rop \lim\limits_{i \rightarrow \infty}d\rop \phi_i =
    %     \int_\gamma \rop d\tilde{\psi} = 0.
    % \end{align*}
\end{proof}

\begin{lemma}\label{lem:extension_by_zero}
    Let $\Omega$, $U$ be open and $U \subseteq \Omega$. 
    Let $\nu \in \mathring{H}^k(d;U)$. Define $\bar{\nu}$ as the 
    zero extension of $\nu$ in $\Omega \setminus U$. 
    Then $\bar{\nu} \in \mathring{H}^k(d;\Omega)$ and 
    $d\bar{\nu} = d\nu$ in $U$ and $d\bar{\nu} = 0$ in $\Omega \setminus U$.
\end{lemma}
\begin{proof}
    The proof works exactly as in the standard Sobolev case. 
    Take $\varphi \in \smoothcompforms{k}{\Omega}$ arbitrary. 
    Define $\bar{\nu}' = d\nu$ in $U$ and $\bar{\nu}' = 0$ in 
    $\Omega \setminus U$. We want to show that 
    \begin{align*}
        \int_\Omega \bar{\nu} \wedge *\delta \varphi 
        = \int_\Omega \bar{\nu}' \wedge *\varphi
    \end{align*}
    which implies that $\bar{\nu}' = d\bar{\nu}$. If
    $\text{supp}\, \varphi \subseteq U$ this follows by applying the definition 
    of $d\nu$. If $\text{supp}\, \varphi \subseteq 
    \text{int}(\Omega \setminus U)$ then it is also trivial since both 
    $\bar{\nu}$ and $\bar{\nu}'$ are zero in $\Omega \setminus U$. 

    Otherwise, we recognize $\varphi |_U \in C_c^\infty \Lambda^{k+1}(U)$. 
    %Did I define that space?
    Thus we get from the definition of the zero boundary condition 
    (Def.~\ref{def:zero_boundary_condition})
    \begin{align*}
        \langle \bar{\nu}, \delta \varphi \rangle_{L^k_2(\Omega)}
        = \langle \nu, \delta \varphi \rangle_{L^k_2(U)}
        = \langle d\nu, \varphi \rangle_{L^{k+1}_2(U)}
        = \langle \bar{\nu}', \varphi \rangle_{L^{k+1}_2(\Omega)}.
    \end{align*}
    Thus, $\bar{\nu}' = d\bar{\nu}$. Because $d\nu \in L^{k+1}_2(U)$,
    $d\bar{\nu} \in L^{k+1}_2(\Omega)$ and the lemma is proven.
\end{proof}

Now we construct a solution. Let $L \subseteq K$ be a bounded
simplicial subcomplex s.t. $\gamma \in C_1(L)$ and the star of 
every vertex from $\gamma$ does not touch the boundary of $L$. 
We also require that $H_1(L) = \integers [\gamma]$.
Let $\rop_L$ be 
the regularization operator from Thm.\,\ref{thm:operators}, but now constructed for
$L$ instead of $K$.

We know from Prop.~\ref{prop:uniqueness_cochain} 
that a closed cochain $F \in C^1(L)$ 
exists s.t. $F(\gamma) = C_0$. 
We know from \ref{} that $[I]: \mathscr{H}^1(L) \rightarrow H^1(L)$ is a 
isomorphism. Thus we find a $\tilde{\theta} \in S^1(L)$ s.t. 
$[I(\tilde{\theta})] = [F]$
i.e. $I(\tilde{\theta}) = F + \delta J$ for some $J\in C^0(L)$. Thus 
$I(\tilde{\theta}) = F(\gamma) + (\delta J)(\gamma) 
\stackrel{\gamma \text{ closed}}{=} 
F(\gamma) = C_0$.

Because $L$ is a finite simplicial complex every cochain is $2$-summable 
i.e. $\tilde{\theta} \in S^1_2(L)$. 
Continue by defining $\theta \vcentcolon= \phi^{-1}\tilde{\theta}
\in S_2^1(|L|) \subseteq W^1_2(|L|)$.
By our definition of integration \ref{}
we have then $I(\theta) = C_0$ and due to Lemma \ref{} 
\begin{align*}
    \int_\gamma \rop_L \theta = \int_\gamma \theta = C_0.
\end{align*} 

We now use the Hodge decomposition
(\ref{hodge_decomposition}) and project $\theta$ onto the harmonic functions 
to obtain $\omega_L \in \mathring{H}^1_0(d,\delta;|L|)$ with 
\begin{align*}
    \omega_L = \theta_L - d\psi
\end{align*}
with $\psi \in H^0(d;|L|)$. {\color{red} We need here that $d$ and $\delta$ 
have closed range on bounded domains!}
\begin{align*}
    \int_\gamma \rop_L \omega_L 
    = \int_\gamma \rop_L (\theta - d\psi) 
    \stackrel{d\rop_L = \rop_L d}{=}\int_\gamma \rop_L \theta 
    = \int_\gamma \theta = C_0.
\end{align*}
Because $\omega_L \in \mathring{H}^1(d;|L|)$ we can use 
Lemma~\ref{lem:extension_by_zero} extend it by zero to 
obtain $\bar{\omega}_L \in H^1(d;\Omega)$ which is closed {\color{red} Here we 
definitely need $|L|$ open.} 
Because the construction of the operator $\rop$ is local on the stars 
of the vertices
(cf. Remark~\ref{rem:local_construction_regularization}) 
we have $\rop_L \omega_L = \rop \bar{\omega}_L$ on 
every simplex attached to $\gamma$ because $\rop_L$ and $\rop$ are constructed
in the same manner. Therefore 
$\int_\gamma \rop_L \omega_L = \int_\gamma \rop \bar{\omega}_L = C_0$. 
Now we project $*\bar{\omega}_L$ onto harmonic forms to get 
$\omega \in \mathring{H}^2_0(d,\delta;\Omega)$. Because the domain $\Omega$
is unbounded the image of $d$ and $\delta$ are not closed anymore. So because 
$*\bar{\omega}_L$ is co-closed we 
obtain a sequence $(\phi_i)_{i \in \naturalnum} \subseteq H^3(\delta)$ s.t.
\begin{align*}
    *\bar{\omega}_L = \omega + \lim\limits_{i \rightarrow \infty}\delta \phi_i.
\end{align*}
where the limit is in the $L^2$-sense. Apply the Hodge star operator on 
both sides, use the fact that it is an isometry and thus continuous and then 
remember the definition of $\delta$ to get a sequence 
$(\psi_i)_{i \in \naturalnum} \subseteq H^0(d)$ s.t.
\begin{align*}
    \bar{\omega}_L = *\omega + \lim\limits_{i \rightarrow \infty}d \psi_i.
\end{align*}
Then we get
\begin{align*}
    \int_\gamma \rop * \omega 
    =\int_\gamma \rop (\bar{\omega}_L - 
    \lim\limits_{i \rightarrow \infty}d \psi_i) = 
    \int_\gamma \rop \bar{\omega}_L = C_0.
\end{align*}
Thus $\omega$ fulfills the integral condition. 
Because $\omega \in \mathring{H}^2_0(d,\delta;\Omega)$ all other conditions 
are satisfied as well and $\omega$ is a solution.


In the proof of uniqueness we will use the following lemma. 
We are now back in the realm of standard vector analysis so all the notation
is to be seen in this light (e.g. $H^1$ is here the standard Sobolov space 
and not related to differential forms).

\begin{lemma}
    Let $\phi \in L^2_{loc}(\Omega)$ with $\nabla \phi \in L^2(\Omega)$. Then 
    there exists a sequence $(\phi_i)_{i \in \naturalnum} \subseteq H^1(\Omega)$
    s.t. $\nabla \phi_i \rightarrow \nabla \phi$ in $L^2(\Omega)^3$.
\end{lemma}
\begin{proof}
    Take $B_R$ with $R$ large enough s.t. $B_R^c \subseteq \Omega$. 
    Define $\Omega_R \vcentcolon= B_R \cap \Omega$. Then 
    $\overline{\Omega}_R \subseteq B_{R+1}$ and $\Omega_R$ is a Lipschitz 
    domain and $B_{R+1}$ is pre-compact and
    $\phi|_{\Omega_R} \in W^{1,2}(\Omega_R)$. Therefore we can find an extension
    $E\phi \in W_0^{1,2}(\Omega_{R+1}) \hookrightarrow W^{1,2}(\mathbb{R}^3)$
    (cf. \cite[Thm.\,5.2.1]{sobolev}). So we can now define
    \begin{align*}
    \bar{\phi} \vcentcolon=
    \begin{cases}
        \phi & \mbox{in $\Omega$}\\
        E\phi & \mbox{in $\Omega^c$.}\\
    \end{cases}
    \end{align*}
    Then $\bar{\phi} \in L^2_{loc}(\real^3)$ and 
    $\nabla \bar{\phi} \in L^2(\real^3)^3$. 
    Then there exists a sequence $(\phi_l) _{l \in \naturalnum}$ s.t.
    $\nabla \phi_l \rightarrow \nabla \bar{\phi}$ in $L^2(\real^3)^3$ 
    (cf. \cite[Lemma\,1.1]{simader}). By restricting $\phi_l$ to $\Omega$ 
    we obtain the result.
\end{proof}

% First we compute
% \begin{align*}
%     \delta *\eta = (-1)^{n(k-1)+1} *d**\eta = (-1)^{n(k-1)+1} *d\eta = 0.
% \end{align*}
% Using the Hodge decomposition for unbounded domains 
% (cf. \cite[Lemma 1]{picard}) we get therefore that there exists 
% a sequence  $(\phi_i)_{i\in \mathbb{N}} \subseteq H^3(\delta,\Omega)$ 
% and a harmonic $\omega \in \mathring{H}^2(d) \cap H^3(\delta)$ s.t. 
% \begin{align*}
%     *\eta = \lim\limits_{i \rightarrow \infty} \delta \phi_i + \omega.
% \end{align*}
% where the limit is in $L^1_2(\Omega)$. 


% We will show that $\omega$ is then a solution. Because $\omega$ is harmonic
% we already know that $d\omega = 0$, $\delta \omega = 0$ and 
% $\omega \in \mathring{H}^2(d)$. It remains to show that the integral condition
% (\refeq{integral_condition}) is also satisfied.

% At first we check that the integral is well-defined. We have $\delta \omega = 0$
% which implies
% \begin{align*}
%     d * \omega = ** d*\omega = (-1)^{n(k-1)+1} *\delta \omega = 0
% \end{align*}
% so $*\omega$ is a closed 1-form. Therefore the integral is well-defined as shown
% in Sec.\,\ref{well_definedness_integral}.

% Take a ball of radius $R>0$ 
% around the origin with $R$ large enough s.t. $\gamma \subseteq B_R$. 
% Using the fact that the range of $\delta$ is closed on bounded domains 
% (cf. \cite[Lemma 7]{picard}) there is some $\phi_R \in H^3(\delta;B_R)$ s.t.
% \begin{align*}
%     *\eta|_{B_R} = \omega|_{B_R} + \delta \phi_R.
% \end{align*}
% We then get for the integral condition (\ref{integral_condition}) 
% \begin{align*}
%     \int_\gamma *\omega &= \int_\gamma *\omega|_{B_R} = 
%     \int_\gamma *(*\eta|_{B_R} - \delta \phi_R) = 
%     \int_\gamma \eta|_{B_R} - (-1)^{3\cdot 2+1} d * \phi_R \\
%     &= \int_\gamma \eta|_{B_R} = C_0
% \end{align*}
% so the integral condition (\refeq{integral_condition}) is fulfilled and 
% $\omega$ is indeed a solution. \newline
% {\color{red} TBD: Put all this in a theorem.}

% If we now take the Hodge decomposition
% $L^2_2(\omegabar) = \bar{\mathfrak{B^k}} \oplus \mathcal{H}^k \oplus
% \bar{\mathfrak{B^*_k}}$ and define $\omega$ as the projection of $\eta$ onto the
% harmonic forms $\mathcal{H}^k$. Then we know that $d\omega = 0$, 
% $\delta\omega = 0$ and $\text{tr}\,\omega = 0$. So we only have to show that
% \begin{align*}
% \int_\gamma \omega = C_0.
% \end{align*}

% We know from the Hodge decomposition that there exists a sequence
% $(\phi_i)_{i\in \mathbb{N}} \subseteq L^{k-1}_2(M)$ s.t. 
% $\omega = \eta - \lim_{i \rightarrow \infty} d\phi_i$.
% Let now be $R>0$ large enough s.t. $\gamma \subseteq B_R$. Then we know that
% $d W^{k-1}_2(B_R)$ is closed in $L_2^k(B_R)$. \cite{}  Therefore there exists 
% $\phi_R \in  W^{k-1}_2(B_R)$ s.t. 
% $\lim_{i \rightarrow \infty} d\phi_i|_{B_R} = d\phi_R$. So we have
% $\omega|_{B_R} = \eta|_{B_R} - d\phi_R$ and 
% \begin{align*}
% \int_\gamma \omega = \int_\gamma \omega|_{B_R} = \int_\gamma \eta|_{B_R} = C_0.
% \end{align*}
% This proves existence.

\begin{theorem}
    The solution of the problem is unique.
\end{theorem}
\begin{proof}
    Let $\omega$ and $\tilde{\omega}$ both be solutions. Then $*\omega$ is 
    closed thus $\rop *\omega \in S_2^1(\omegabar)$ is also closed because 
    \begin{align*}
        d \rop * \omega = \rop d*\omega = 0.
    \end{align*}
    The same 
    holds for $\tilde{\omega}$. 
    $I(\rop * \omega), I(\rop * \tilde{\omega}) \in C^1_2(K)$ 
    are closed $1$-cochains with
    $I(\rop * \omega)(\gamma) = I(\rop * \tilde{\omega})(\gamma)$. 
    Thus Prop.\,\ref{prop:uniqueness_cochain} implies 
    $[I(\rop * \omega)] = [I(\rop * \tilde{\omega})] \in H^1(K;\real)$.
    Now we use the Whitney transformation. {\color{red} No we dont.} 
    We know that $[I]$ and $[w]$ are 
    inverses on cohomology from \ref{}. That means we get 
    \begin{align*}
        [\varphi \rop *\omega] = [wI\varphi \rop *\omega] 
        = [wI\varphi \rop *\tilde{\omega}] = [\varphi \rop *\tilde{\omega}].
    \end{align*}
    Here the cohomology classes are in the cohomology spaces of S-forms 
    $\mathscr{H}^1(K)$. That means there is a S-form $\theta \in S^0(K)$ s.t.
    \begin{align*}
        &\varphi \rop *\omega - \varphi \rop *\omega = d\theta \\ 
        &\Rightarrow \rop *\omega -  \rop *\omega = \varphi^{-1} d\theta 
        = d\varphi^{-1}\theta =\vcentcolon d\tilde{\theta}.
    \end{align*}
    We have $\tilde{\theta} \in S^0(\omegabar) \subseteq 
    W_{\infty,loc}^0(\omegabar)$ and $d \tilde{\theta} \in S_2^1(\omegabar)
    \subseteq W_2^1(\omegabar)$.

    Using the 
    properties of $\rop$ there exists a $\eta \in L_{2,loc}^0(\Omega)$
    with $d\eta \in L^1_2(\Omega)$ s.t. 
    \begin{align*}
        *\omega - *\tilde{\omega} = -d\aop(*\omega - *\tilde{\omega})
        + d \theta = d\eta.
    \end{align*}
    By applying the Hodge star operator on both sides we find 
    $\mu \in L_{2,loc}^3(\Omega)$ with $\delta \eta \in L^2_2(\Omega)$ s.t.
    \begin{align}
        \omega - \tilde{\omega} = \delta \mu. \label{difference_solutions}
    \end{align}
    But because $\mu$ is only in $L_{2,loc}^3(\Omega)$ 
    we can not immediately conclude that $\delta \mu = 0$.

    Let us briefly return to vector proxies. Let $B$ and $\tilde{B}$ be 
    vector proxies of $\omega$ and $\tilde{\omega}$ respectively. 
    (\refeq{difference_solutions}) then translates to 
    $B, \tilde{B} \in \mathring{H}(\diver)$ %TBD: Not defined
    and $B-\tilde{B} = \nabla \phi$ with $\phi \in L^2_{loc}(\Omega)$ and
    $\nabla \phi \in L^2(\Omega)^3$.
    Because $B$ and $\tilde{B}$ are both harmonic we have 
    \begin{align*}
        0 = \int_\Omega (B-\tilde{B}) \cdot \nabla f\, dx 
        = \int_\Omega \nabla \phi \cdot \nabla f \,dx
        \quad \forall 
        f \in H^1(\Omega).
    \end{align*}
    % Let $\rho_\epsilon$ be a standard mollifier with compact support. 
    % Then we have 
    % \begin{align*}
    %     \partial_{x_i} (\rho_\epsilon * \phi) = 
    %     (\partial_{x_i} \rho_\epsilon) * \phi = 
    %     \rho_\epsilon * (\partial_{x_i} \phi) 
    %     \xrightarrow{\epsilon \rightarrow 0} 
    %     \partial_{x_i} \phi \text{ in $L^2(\Omega)$}.
    % \end{align*}
    % In the last step it is crucial that $\partial_{x_i} \phi \in L^2(\Omega)$.
    Thank to Lemma\,\ref{} we know that 
    $\nabla \phi \in \overline{\nabla H^1(\Omega)}$. 
    Because $B$ and $\tilde{B}$ are harmonic we have 
    $B - \tilde{B} \in 
    \overline{\nabla H^1(\Omega)}^\perp$ and hence $\nabla \phi = 0$
    and $B = \tilde{B}$. Because the corresponding vector proxies are equal we 
    we obtain $\omega = \tilde{\omega}$.
\end{proof}



% \begin{proof}
%     Let $\omega, \tilde{\omega}$ both be solutions. 
%     Because  $*\omega$ and
%     $*\tilde{\omega}$ are closed the cochains 
%     $c\mapsto \int_c \rop*\omega$ and 
%     $c\mapsto \int_c \rop*\tilde{\omega}$ are closed.
    
%     Due to $\int_\gamma \rop *\omega = \int_\gamma \rop *\tilde{\omega}$ and the 
%     assumption that $[\gamma]$ spans the homology space we have with 
%     Prop.\,\ref{uniqueness_cochain} 
%     $[I(\rop *\omega)] = [I(\rop *\tilde{\omega})]$
%     and because $[I]$ is an isomorphism 
%     $[\rop *\omega] = [\rop *\tilde{\omega}]$. Hence,
%     \begin{align*}
%     [*\tilde{\omega}] = [\rop *\tilde{\omega}] = 
%     [\rop *\omega] = [*\omega].
%     \end{align*}
%     That is equivalent to the
%     existence of some $0$-form $\phi \in H^0(d)$ s.t.
%     $*\omega = *\tilde{\omega} + d\phi$. We continue by applying the Hodge
%     star operator to both sides and use the definition of the codifferential 
%     $\delta$:
%     \begin{align*}
%         \omega = \tilde{\omega} + *d\phi = \tilde{\omega} + *d**\phi 
%         = \tilde{\omega} + (-1)^{(n-k)(k-1)+1}\delta * \phi.
%     \end{align*}
%     Then because $\omega$ and 
%     $\tilde{\omega}$ are harmonic we have 
%     $\omega, \tilde{\omega} \perp \delta H^{3}(\delta)$ and therefore 
%     \begin{align*}
%     \omega = \tilde{\omega}.    
%     \end{align*}
% \end{proof}
% If we now translate this back to standard vector calculus terms we have found 
% the unique solution of the homogeneous magnetostatic on our domain $\Omega$.

% \section{Application: Homogeneous magnetostatic problem on the 
% exterior domain of a torus}

% As an application of this general boundary value problem we will have a look
% at the following magnetostatic problem. Let $\Omega$ be the exterior domain of
% a triangulated torus i.e. $\real^3 \setminus \Omega$ is a torus with 
% triangulated surface. Let $B$ be the magnetic field. We then have the following
% boundary value problem:
% %%%TBD: Include a picture
% It is natural to identify the magnetic field $B$ with a 2-form $\omega$.
% Then the exterior derivative is $d\omega$ corresponds to the divergence,
% the codifferential $\delta$ corresponds to the curl and the normal component
% being zero is corresponds to $\omega \in \mathring{W}^2_2(\Omega)$.\cite{}. 
% The curve integral is an integration over a one-dimensional manifold and
% corresponds therefore to the integration of a one-form. Therefore the
% condition \ref{curve_integral_contition} is can be expressed with the hodge 
% star operator $*$ as
% \begin{align*}
%     \int_\gamma *\omega = C_0.
% \end{align*}


% Now we want to apply our previous results.
% $\Omega$ fulfills all required assumptions for the domain. Because $\gamma$
% goes around the torus once and the homology space $H^1_c$ is one-dimensional
% {\color{red}(TBD: This has to be referenced or proven)}. Therefore because 
% $\gamma$ is not a boundary $[\gamma]$ spans $H^1_c$. Now all assumptions are
% fulfilled and we can apply our result. We will do so on 1-forms and transfer the
% result to 2-forms using the Hodge star operator.

% \subsection*{Existence}
% Let 
% $\tilde{\omega} \in \mathring{W}^1_2(\Omega) $ be the unique solution of our 
% general problem \ref{} and define $\omega \vcentcolon= *\tilde{\omega}$. Then
% we use $**=(-1)^{k(n-k)}\tilde{\omega} = \tilde{\omega}$ \cite[p.66]{arnold} 
% to get 
% \begin{align*}
%     d\omega = ** d*\tilde{\omega} = * (-1)^{n(k-1)+1} \delta \tilde{\omega}
%     = 0
% \end{align*}
% and
% \begin{align*}
%     \delta \omega = (-1)^{n(k-1)+1} *d*\omega = (-1)^{n(k-1)+1}* d\tilde{omega}
%     = 0.
% \end{align*}



%%% TBD: Nowaczyk's thesis is not a master's thesis
\printbibliography
\end{document}